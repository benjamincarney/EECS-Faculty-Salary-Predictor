

$( document ).ready(function() {
  $( ".sideNavBurger" ).click(function(e) {
    e.preventDefault();
    $( ".phone-sidenav" ).slideToggle( "fast", function() { });
  });
});
// $(document).ready(function() {
//     $('.person-profile-wrap .equalHeight').each(function() {
//         $(this).children('.matchHeight').matchHeight(true);
//     });
// });
$(document).ready(function () {

	$(".audience-nav-item .audItem").hoverIntent( function() {
	    var name = $(this).attr('data-hover');
	    if ($('#audMenu-' + name).hasClass('open')) {
	        // Do nothing
	    } else {
	        $('.level-two-nav.open').slideToggle('fast').removeClass('open');
	        $('#audMenu-' + name).addClass('open').slideToggle('fast');
	    }
	});

	$(".department-nav-hoverzone").hoverIntent( function() {}, function() {
		$('.level-two-nav.open').slideToggle('fast').removeClass('open');
	});
	
	$(".audience-nav-item a.audItem").click( function() {
    	if ( Math.max(document.documentElement.clientWidth, window.innerWidth || 0) < 992 ) {
            var name = $(this).attr('data-hover');
		   	if ( $('#audMenu-' + name).hasClass('open') == false && $('#audMenu-' + name).length != 0 ) {
    	        event.preventDefault();
    	        $('.level-two-nav.open').slideToggle('fast').removeClass('open');
    	        $('#audMenu-' + name).addClass('open').slideToggle('fast');
    	    }
    	}
	});

  if (!Modernizr.svg) {
    $(".header-wrap .fallback").show();
  }

});

/*
 *  uses sling search servlet by calling the lsa_search from any page. 
    getting 11 showing 10. If there are 11, then show next button
     - show 11 through 20, getting 11-22...
     - adds params to URL (not going to reload)
     - parse params if any on-load, get and show results for shared search result URL's
     - confirm analytics will catch the ajax search call,
 */
$(function(){

  var nativeDataList = ('options' in document.createElement('datalist'));

  var urlSearch = $('.lsa-site-searchbtn').attr('data-search-path');
  if (!urlSearch) {
    urlSearch = "/content/michigan-lsa/en.lsa_search.xml";
  }

  var gatewaySearch = $("#searchGateway").length;

  var searchingIconClass = "fa-circle-o-notch fa-spin";  
  var searchIconClass = "fa-search"; 
  var closeIconClass = "fa-times";

  var footline = "<div class=\"footline\" id=\"search-footline\"> <div class=\"lsa-pagination\"> "+
      "<a href=\"#\" class=\"previous themeText inactive\">previous</a> <span class=\"seperator themeText\"> | </span>"+
      "<a href=\"#\" class=\"next themeText inactive\">next</a> </div> </div> ";
  
  var searchObj = {};

  if(gatewaySearch === undefined || gatewaySearch < 1){
    searchObj["site"] = $('button.lsa-site-searchbtn').data('lsa-collection');
  }

  searchObj["originSite"] = location.origin;   
  searchObj["num"] = 11;
  searchObj["start"] = 0;  
  searchObj["hasnext"] = true;

  var flag = false;


  var encodeSearchPhrase = function(phrase){
    return encodeURIComponent(phrase);
  }

  var decodeSearchPhrase = function(encodedPhrase){
    return decodeURIComponent(encodedPhrase);
  }

  var getResults = function(e){  // rename to getResultsFromUri

    setSearchMode();
    if(e !== undefined ){ // if e is a click event      
      e.preventDefault();   
      /* 
       * e could be click from search form, XS search form, Next or Previous
       * e could be a submit type from the enter button
       * e could be undefined, in which case it's a shared searched URI
       */
      // get or set start
      var startAt = $.bbq.getState("start");
      if (startAt === undefined) {
        startAt =  searchObj["mode"] == 'cse' ? 1 : 0;        
        searchObj["start"] = startAt;
      }
    } else { // search from URI
      searchObj["q"] = lsaEscapeBbqSearchString($.bbq.getState("q"));
      searchObj["start"] = $.bbq.getState("start");
    } 
    // make query
    if(searchObj["q"] != undefined && searchObj["q"] != "" && searchObj["mode"] === "gateway"){
      queryGateway();
    } else if ((searchObj["q"] != undefined && searchObj["q"] != "") && searchObj["site"] !=undefined && searchObj["site"] !="" ) {
        // && searchObj["mode"] === "gsa"
      queryGSA();
    }

    if(searchObj["q"] != undefined && searchObj["q"] === ""){
      resetSearchButtons();
    }    
  }

  var handleSearchBtn = function(e){
    e.preventDefault();
    setSearchMode();
    searchObj["start"] = searchObj["mode"] == 'cse' ? 1 : 0; 

    if(location.hash !== "" && (location.hash.includes('mode=gsa') || location.hash.includes('mode=gateway') || location.hash.includes('mode=cse'))) {
       var searchTerm = decodeSearchPhrase($.bbq.getState("q").trim());

       if(searchObj["mode"] == "gsa" || searchObj["mode"] == "cse") {

          var activeElementId = document.activeElement.id;

          if((activeElementId === "siteSearchSubmit" || activeElementId === "umlsaSearch") && $("#umlsaSearch").val().trim() === searchTerm) {
            return false;
          }
          if((activeElementId === "siteSearchSubmitMobile" || activeElementId === "umlsaSearch-mobile") && $("#umlsaSearch-mobile").val().trim() === searchTerm) {
            return false;
          }
       } else if (searchObj["mode"] == "gateway" && $("#searchGateway").val().trim() === searchTerm)  {
          return false;
       }
    }

    if($("#searchGateway").val() === "" && searchObj["mode"] === "gateway"){
      return false;
    }

    setSearchButtons();
    var inputSelector, clearOther;      
    var clickedEle = $(this); 
    
    if(clickedEle != undefined && (clickedEle.hasClass("lsa-site-searchbtn") || clickedEle.hasClass("lsa-multi-collection") ) && (searchObj["mode"] === "gsa" || searchObj["mode"] == "cse")){
      // if e is new search click event   
      // console.log("clicked or enter button");
      if( $('#phone-search').is(':visible') ) {
        inputSelector = "div#phone-search input.header-search-text";
        clearOther = "div.header-search input.header-search-text";
      } else {
        inputSelector = "div.header-search input.header-search-text";  
        clearOther = "div#phone-search input.header-search-text";     
      }     
      searchObj["q"] =  $(inputSelector).val().trim(); // 
      $(clearOther).val("");
    }

    if(clickedEle != undefined && clickedEle.hasClass("lsa-site-searchbtn") && searchObj["mode"] === "gateway"){
       inputSelector = "#searchGateway";
       searchObj["q"] = $(inputSelector).val().trim(); //
    }

    // hashchange handler makes the query
    pushState();
    return false;
  }

  var clearResults = function(e){
    e.preventDefault();
    location.hash = "";
    location.reload();
  }

  var pushState = function(){    
    $.bbq.pushState({ "q": searchObj["q"], "start":searchObj["start"], "hasnext":searchObj["hasnext"],
      "mode":searchObj["mode"], "site":searchObj["site"] }); 
  }

  var queryGSA = function(){
    qString = searchObj["q"]; 
    if( typeof ga !== "undefined"){ //check whether tracking analytics
      ga('send', 'pageview', location.pathname+'?q='+searchObj["q"]); 
      ga('newTracker.send', 'pageview', location.pathname+'?q='+searchObj["q"]); 
    } 
    var jqxhr  = $.get(urlSearch , searchObj)
      .done(function(data){ 
        showResults(data); 
        trackSearchClicks();
        $('button.lsa-site-searchbtn').off(); //'click', getResults     
        $('button.lsa-site-searchbtn').on('click', clearResults );  
        $(".header-search-text").on('click keydown', resetSearchButtons);
        closeSearchButtons();
      }).fail(function(e){ 
        console.log("On site search failed"); 
        console.log(e); 
        resetSearchButtons();
        alert("Something went wrong with your search. Please reload the page and try again. There may be more information about the problem in the JavaScript console.")
      });
  }

  var queryGateway = function(){
    if( typeof ga !== "undefined"){ //check whether tracking analytics
      ga('send', 'pageview', location.pathname+'?q='+searchObj["q"]);
      ga('newTracker.send', 'pageview', location.pathname+'?q='+searchObj["q"]);
    }
    $.ajax({
      url: urlSearch + "?q=" + searchObj["q"] + "&start=" + searchObj["start"],
      type: 'GET',
      dataType: 'json',
      contentType: 'application/json',
      timeout: 15000,
      success: function (data) {
        showGatewaySearchResults(data);
        trackSearchClicks();
        resetSearchButtons();
        if(nativeDataList){
          $('#searchGateway').on('keyup', changeInput);
          $('#searchGateway').on('click', populateFrequentSearchTerms)
        }
      },
      error: function(data,status,er) {
        var response = confirm("Something went wrong with your search: "+decodeSearchPhrase(searchObj["q"])+
          ".\n\nPlease try again in a few minutes, execute the search from another page or submit a ticket if the problem persists.\n  "+
          "Press OK to try again. Press Cancel to reset the page. ");
          if( typeof ga !== "undefined"){ //check whether tracking analytics
            ga('send', {
              hitType: 'event',
              eventCategory: 'Gateway Search',
              eventAction: 'error',
              eventLabel: location.pathname+'?q='+searchObj["q"],
              hitCallback: createFunctionWithTimeout(function() {
                if (response == true) {
                  location.reload();
                } else {
                  location = location.pathname;
                }
              })
            });  
          }
      }
    });
  }


  var showGatewaySearchResults = function(data){
    var result = data['result']
    var displayResults = '';

    $.each(result, function (index, output) {
      var path = output.path;
      var origin = searchObj["originSite"];
      var fileExt = path.split('.').pop();
      var extension = '';
      if(fileExt === path && path !== '/') {
        extension = ".html";
      }
      else {
        path = path.split(' ').join('%20');
      }
      if(path === '/') {
        path = searchObj["originSite"];
        origin = '';
      }
      displayResults += "<p style=\"margin: 0px;\"><a class=\"themeLink themeText search-result\" style=\"font-size: 110%;\" href=" + path + extension + ">" + output.title + "</a></p>" +
                          "<p style=\"color: green; font-size: 85%; margin-bottom: 15px;\">" + origin + path + extension + "</p>";
    });

    if (displayResults === ""){
      displayResults = "<p class=\"themeText\">No results found for " + decodeSearchPhrase( searchObj["q"].trim()) + "</p>";
    }
    var pageNumber = (searchObj["start"] / 10) + 1;
    var test =  "<div id=\"search-footline\" style=\"margin: auto;width: 50%; padding: 10px;\"><div style=\"text-align:center;\"><p style=\"color: black;\">Page " +
                   "<span id=\"pageNavigation\">" + pageNumber + "</span></p><a href=\"#\" class=\"previous themeLink themeText disableAnchor\" style=\"color: Gray;\">previous</a> <span class=\"seperator\"> | </span>"+
                   "<a href=\"#\" class=\"next themeLink themeText disableAnchor\" style=\"color: Gray;\">next</a></div></div>";
    displayResults += test;
    $("#testSearch").html("");
    $("#testSearch").append(displayResults);
    var resultMeta = data['resultMeta'];
    if(resultMeta['hasMoreResults']){
      $("#search-footline a.next").removeClass('disableAnchor');
      $("#search-footline a.next").removeAttr("style");
      searchObj["hasnext"] = true;
    } else {
      searchObj["hasnext"] = false;
    }
    var start = $.bbq.getState("start");
    if (start < 10 || start === undefined) {
      $("#search-footline a.previous").addClass('disableAnchor');
    } else {
      $("#search-footline a.previous").removeClass('disableAnchor');
      $("#search-footline a.previous").removeAttr("style");
    }

    $("#search-footline a.previous").bind('click', handlePrevious);
    $("#search-footline a.next").bind('click', handleNext);

    //PUSH STATE
    // hashchange handler makes the query
    pushState();
  }

  var formatResult = function(resObj){
    var p = $('<p class="g themeLink themeText"> </p>');
    var a = $('<a class="themeLink themeText search-result"></a>'); // needs rank , href, title
    a.attr('rank', resObj['number']);
    a.attr('href', resObj['link']);
    a.append($('<span class="l themeLink themeText"></span>').append((resObj['title']))[0].innerHTML);
    p.append(a);
    var table = $('<table cellpadding="0" cellspacing="0" border="0"> <tbody>'+
    ' <tr> <td class="s"> </td> </tr> </tbody></table>');
    table.find('td').append(resObj['htmlSnippet']);
    var linkLbl = $('<font color="#7E6518" size="-1"> </font>');
    table.find('td').append(linkLbl);
    p.append(table);
    return p[0].innerHTML+'<br/>';
  }

  var formatKeymatch = function(keymatch){
    var a = $('<a class="lsa-gsa lsa-gsa-keymatch themeLink themeText"></a>');
    a.attr('href', keymatch.link);
    a.attr('title', keymatch.title);
    a.append(keymatch.title)
    return a[0].outerHTML+" <br/>";
  }

  var processXmlData = function(xmlData){
    var processedResults = { promotions : [], items : [] };
    var results = $(xmlData).find('R');
    var keymatches = $(xmlData).find('GM');
    
    keymatches.each(function(){
      var keymatch = {
        title : this.getElementsByTagName('GD')[0].textContent,
        link : this.getElementsByTagName('GL')[0].textContent
      }      
      processedResults.promotions.push(keymatch);
    });

    results.each(function(){
      var resultSet = {
        title : this.getElementsByTagName('T')[0].textContent,
        link : this.getElementsByTagName('U')[0].textContent,
        htmlSnippet : this.getElementsByTagName('S')[0].textContent,
        number : this.getAttribute('N'),
      }
      processedResults.items.push(resultSet);
    });
    return processedResults;
  }  

  var showResults = function(ajaxResp){
// takes the search response as argument. could be json (csa) or xml (gsa)
// if the response is xml from the gsa, then process the xml
    if (searchObj["mode"] == "gsa") {
      data = processXmlData(ajaxResp);
    } else {
      data = ajaxResp;
    }
    var resultsHtml = "";
    var pageNumber = Math.floor( searchObj['start']/10 + 1 );
    var searchPageHeading = '<h3 class="search-page-heading themeText">Search Results Page '+pageNumber+'</h3>';
    if( data.promotions != undefined){
      data.promotions.forEach(function(keyMatch){
          resultsHtml += formatKeymatch(keyMatch) ;
      });
    }
    var showNext =false, showPrevious=false;
    if( data.items != undefined){
      data.items.forEach(function(item){
          resultsHtml += formatResult(item) ;
      });      
    }
    if (resultsHtml == ""){
      resultsHtml = "<p>No results found for "+decodeSearchPhrase( searchObj["q"].trim()) +"</p>";
    }
    resultsHtml += $(footline)[0].outerHTML;
    resultsHtml = searchPageHeading+resultsHtml;
    var resultsSelector = $("body").data("lsa-search-results-selector") ;
    resultsSelector = resultsSelector ? resultsSelector : "div.col-sm-8.col-xs-12";
    $(resultsSelector).first().addClass('search-gsa-results-wrap').empty().attr("style", "background-color: white; ");
    $(resultsSelector).first().append(resultsHtml);
// Adjustments for LSA HP
    $('.video-banner-wrap,.lsa_top_content_area').empty();
    $("div.video-lsa-hp-container ~ div#content section.container:first-of-type ").attr("style", "margin-top :0; margin-bottom :0;");
// Handle Next Previous the GSA way
    if(searchObj["mode"] == 'gsa') {
      var gsaResults = $(ajaxResp).find('R');
      if(gsaResults.length >= 11){
        showNext = true;
        gsaResults = gsaResults.slice(0,10);
        $("#search-footline a.next").removeClass('inactive');
        searchObj["hasnext"] = true;
      } else {
        searchObj["hasnext"] = false ;
      }
    } else if (searchObj["mode"] == 'cse') {
// Handle Next / Previous buttons the CSE way        
        if (data.queries.nextPage != undefined){
          showNext = true;
          searchObj["hasnext"] = true;
          $("#search-footline a.next").removeClass('inactive');
        } 
        if (data.queries.previousPage != undefined){
          showPrevious = true;
        } 
    }
    showHidePrevBtn();
    var previousBtn = $("#search-footline a.previous").bind('click', handlePrevious);
    var nextBtn = $("#search-footline a.next").bind('click', handleNext);

    //PUSH STATE
    // hashchange handler makes the query
    pushState()
  }

  var showHidePrevBtn = function(){
    var start = $.bbq.getState("start");
    if (start < 10 || start === undefined) {
      $("#search-footline a.previous").addClass('inactive');
    } else {
      $("#search-footline a.previous").removeClass('inactive');
    }
  }

  var getPath = function(f_siteCode) {
    var site = f_siteCode.match(/-(\w+)/g);
    if (site === null) {
      site = "lsa";
    } else {
      site = site[0].substring(1).toLowerCase();
    }
    return site;
  }

  var handlePrevious = function(e){
    e.preventDefault();

    var start = $.bbq.getState("start");
    if (start < 10 || start === undefined) {
   //   $("#search-footline a.previous").addClass('inactive');
      return;
    } else {
      start -= 10;
   //   $("#search-footline a.previous").removeClass('inactive');
      searchObj["start"] = start;
    }

    var mode = $.bbq.getState("mode");

    if(mode == "gateway") {
      $("#search-footline a.previous").addClass('disableAnchor');
      $("#search-footline a.next").addClass('disableAnchor');
      $('#pageNavigation').html("");
      $('#pageNavigation').append("<i class=\"fa fa-circle-o-notch fa-spin\"></i>")
    }

    // hashchange handler makes the query
    pushState();
    $("html, body").animate({ scrollTop: 0 }, "fast");
  }

  var handleNext = function(e){
    e.preventDefault();

    var mode = $.bbq.getState("mode");

    if(mode == "gateway"){
         $("#search-footline a.next").addClass('disableAnchor');
         $("#search-footline a.previous").addClass('disableAnchor');
    }

    var start = Number($.bbq.getState("start"));
    var hasMore = $.bbq.getState("hasnext");
    if (hasMore == "true"){
      start += 10;
      searchObj["start"] = start;

      if(mode == "gateway"){
        $('#pageNavigation').html("");
        $('#pageNavigation').append("<i class=\"fa fa-circle-o-notch fa-spin\"></i>")
      }

      // hashchange handler makes the query
      pushState();
    }
    $("html, body").animate({ scrollTop: 0 }, "fast");
  }
  // enable search
  var resetSearchButtons = function(){
    $('button.lsa-site-searchbtn').find('i').removeClass(searchingIconClass)
        .removeClass(searchIconClass).removeClass(closeIconClass).addClass(searchIconClass);
    $('button.lsa-site-searchbtn').removeAttr('disabled');

    var mode = $.bbq.getState("mode");
    if(mode == "gateway" && !nativeDataList)
    {
       $("button.lsa-site-searchbtn").off();
    }
    else
    {
       $("button.lsa-site-searchbtn,.header-search-text").off(); // 'click', resetSearchButtons
    }

    $('button.lsa-site-searchbtn').on('click keydown', handleSearchBtn );
  }

 // disable search, show searching indicator
  var setSearchButtons = function(){
    $('button.lsa-site-searchbtn').find('i').removeClass(searchingIconClass)
        .removeClass(searchIconClass).removeClass(closeIconClass).addClass(searchingIconClass);
    $('button.lsa-site-searchbtn').attr('disabled','disabled');
  }

  var setSearchMode = function(){
    // mode hash takes precedence
    searchObj["mode"] = $.bbq.getState("mode");
    // then check for data attr on search buttons
    if(searchObj["mode"] == undefined) {
      searchObj["mode"] = $("button[data-search-mode]").data("search-mode");
    }
    if (searchObj["mode"] == "cse") {
      searchObj["cx"]  = $("button[data-search-cse-cx]").data('search-cse-cx');
    }
  }

 // enable close,
  var closeSearchButtons = function(){
    $('button.lsa-site-searchbtn').find('i').removeClass(searchingIconClass)
        .removeClass(searchIconClass).removeClass(closeIconClass).addClass(closeIconClass);
    $('button.lsa-site-searchbtn').removeAttr('disabled');
  }

  $('.cancel-search').on('click', clearResults);

  // initialize search buttons
  $('button.lsa-site-searchbtn').on('click', handleSearchBtn );
  $('form.lsa-multi-collection').on('submit' , handleSearchBtn );
  
  if(nativeDataList){
    $('#searchGateway').on('keyup', changeInput );
    $('#searchGateway').on('click', populateFrequentSearchTerms);
  }

  $(".header-wrap input.header-search-text").last().focus(function(){
    $(this).parents('.header-search').addClass('col-sm-5').removeClass('col-sm-3');
  });

  $(".header-wrap input.header-search-text").last().blur(function(){
    if($(this).val() == "") {
      $(this).parents('.header-search').addClass('col-sm-3').removeClass('col-sm-5');
    }
  });

  //handle hash change for back button
  // otherwise the default back btn action
  $(window).bind( "hashchange", function(e) {
    var hash = $.bbq.getState();
    if(hash["mode"] === "gsa" || hash["mode"] === "gateway" || hash["mode"] === "cse" ){
      var start = Number(hash['start']);
      if(start >= 0){
        getResults();
      }
    } else if ($.isEmptyObject(hash)) {
        location.reload();
      }
  });

  // shared uri, reloaded page with search params
  var searchParams = $.bbq.getState();
  if(searchParams["q"] !== undefined && searchParams["start"] !== undefined
    && (searchParams["mode"] === "gsa" || searchParams["mode"] === "gateway" || searchParams["mode"] === "cse")){

    if(searchParams["mode"] === "gateway"){
       $('.gateway-menu').hide();
       $(".gatewayHeaderSearch").show();
       $("#searchGateway").val( decodeSearchPhrase(searchParams["q"].trim()));
    }

    if(searchParams["mode"] === "gsa"){
       $('input.header-search-text').val(decodeSearchPhrase(searchParams["q"].trim()));
    }

    getResults();
  }

   var searchTerms = [];
   var pathName = $('#searchGateway').attr('data-gateway-analytics-path');
   var searchGatewayInput = $("#searchGateway");
   var dataList = document.getElementById("json-datalist");

   if(pathName !== undefined){ // setting up gateway auto complete
     $.ajax({
       url: pathName,
       type: 'GET',
       dataType: 'json',
       contentType: 'application/json',

       success: function (data) {
         $.each(data, function (index, value) {
           searchTerms.push(value);
         });
       },
       error:function(data,status,er) {
         console.log("Analytics data retrieval failed");
       }
     });
   }

 function matchSearchTerms(input) {
   var reg = new RegExp(input.split('').join('\\w*').replace(/\W/, ""), 'i');
   var results = searchTerms.filter(function(term) {
     if (term.match(reg) && term.length < 80) {
       return term;
     }
   });

   updateDatalist(dataList, results);
 }

 var timer = null;

 function changeInput(e) {
   if(e.which === 13)
   {
     $('button.lsa-site-searchbtn').click();
     return false;
   }

   if(timer == null) {
     timer = setTimeout(function() {
       if(e.which !== 38 && e.which !== 40 && e.which !== 13 && e.which !== 37 && e.which !== 39) {
         var val = searchGatewayInput.val();

         if( val.length !== 0 ) {
           matchSearchTerms(val);
         }
         else
         {
            populateFrequentSearchTerms();
         }
       }
     }, 300);

     timer = null;
   }
 }

 function updateDatalist(dataList, datalListOptionsArray){     
   var count = 0;
   var len = datalListOptionsArray.length;

   for(var i = 0; i < len; i++) {
     if(count < 5) {        
       dataList.options[i].value = datalListOptionsArray[i];       
       count++;
     }
     else {
       break;
     }
   }

   if(len < 5) {
     for(var j = count; j < 5; j++) {
       dataList.options[j].value = " ";
     }
   }
 }

 function populateFrequentSearchTerms() {
   var val = searchGatewayInput.val();

   if(val.length === 0) {
     var results = searchTerms.slice(0, 5);
     updateDatalist(dataList, results);
   }
 }

/*
 *
 * Register event tracking for the page
 *
 */
  $('.lsa-button-click,.lsa-slideshow-click,.lsa-giving-click,.lsa-fourbutton-click').on('click', function(event){
    if( typeof ga === "undefined"){
      // escape early if no tracking
      return;
    } // else continue
    event.preventDefault();  
    event.stopPropagation();  
    var selfBtn = $(this);
    var eventCategory = "Button"; // the default
    
    if( selfBtn.hasClass('lsa-slideshow-click') ){
      eventCategory = "Slideshow";
    } else if (selfBtn.hasClass('lsa-giving-click') ){
      eventCategory = "Giving Button";
    } else if (selfBtn.hasClass('lsa-fourbutton-click')) {
      eventCategory = "Four Button";
    }
    ga('send', {
      hitType: 'event',
      eventCategory: eventCategory,
      eventAction: 'click',
      eventLabel: selfBtn[0].text+", "+selfBtn[0].href,
    });
    ga('newTracker.send', {
      hitType: 'event',
      eventCategory: eventCategory,
      eventAction: 'click',
      eventLabel: selfBtn[0].text+", "+selfBtn[0].href,
      hitCallback: createFunctionWithTimeout(function() {
        if  (typeof selfBtn[0] != 'undefined'){
          location = selfBtn[0].href;
          selfBtn = {};
        }
      })
    });
  });

  $("a[href$='.pdf']:not(.lsa-giving-click):not(.lsa-button-click):not(.lsa-slideshow-click):not(.lsa-fourbutton-click),a[href$='.PDF']:not(.lsa-giving-click):not(.lsa-button-click):not(.lsa-slideshow-click):not(.lsa-fourbutton-click),a[href$='#trackdownload']:not(.lsa-giving-click):not(.lsa-button-click):not(.lsa-slideshow-click):not(.lsa-fourbutton-click)").on('click', function(event){
    if( typeof ga === "undefined"){
      // escape early if no tracking
      return;
    } // else continue
    event.preventDefault();  
    event.stopPropagation();  
    var selfBtn = $(this);
    if  (typeof selfBtn[0] != 'undefined' && selfBtn[0].target == "_blank"){
        var winRef = window.open(); 
    }
    ga('send', {
      hitType: 'event',
      eventCategory: 'Download Event',
      eventAction: 'click',
      eventLabel: selfBtn[0].href,
    });

    ga('newTracker.send', {
      hitType: 'event',
      eventCategory: 'Download Event',
      eventAction: 'click',
      eventLabel: selfBtn[0].href,
      hitCallback: createFunctionWithTimeout(function() {
        if  (typeof selfBtn[0] != 'undefined'){
          if (selfBtn[0].target == "_blank"){
            winRef.location = selfBtn[0].href;
          } else {
            location = selfBtn[0].href;
          }          
          selfBtn = {};
        }
      })
    });
  });  

  var trackSearchClicks = function(){
    $("a.search-result").on('click', lsaSearchResultClickHandler); 
  }
  
  $("a[href^='http']:not(.lsa-giving-click):not(.lsa-button-click):not(.lsa-slideshow-click):not(.lsa-fourbutton-click):not(#myCustomTrigger):not(.lb-next):not(.lb-prev):not(.lb-close)").on('click', function(event){
    if( typeof ga === "undefined"){
      // escape early if no tracking
      return;
    } // else continue
    event.preventDefault();  
    event.stopPropagation();  
    var selfBtn = $(this);
    if  (typeof selfBtn[0] != 'undefined' && selfBtn[0].target == "_blank"){
        var winRef = window.open(); 
    }

    ga('send', {
      hitType: 'event',
      eventCategory: 'Outbond Link',
      eventAction: 'click',
      eventLabel: selfBtn[0].href,
    });
    ga('newTracker.send', {
      hitType: 'event',
      eventCategory: 'Outbond Link',
      eventAction: 'click',
      eventLabel: selfBtn[0].href,
      hitCallback: createFunctionWithTimeout(function() {
        if  (typeof selfBtn[0] != 'undefined'){
          if (selfBtn[0].target == "_blank"){
            winRef.location = selfBtn[0].href;
          } else {
            location = selfBtn[0].href;
          }          
          selfBtn = {};
        }
      })
    });
  }); 
  

  var options = [];
  $( '.lsa-collections.dropdown-menu a' ).on( 'click', function( event ) {
     var $target = $( event.currentTarget ),
         val = $target.attr( 'data-value' ),
         $inp = $target.find( 'input' ),
         idx;

     if ( ( idx = options.indexOf( val ) ) > -1 ) {
        options.splice( idx, 1 );
        setTimeout( function() { $inp.prop( 'checked', false ) }, 0);
     } else {
        options.push( val );
        setTimeout( function() { $inp.prop( 'checked', true ) }, 0);
     }
     $( event.target ).blur();

     var optionsPipe = options.join("|");
     searchObj["site"] = optionsPipe; 
     searchObj["q"] =  encodeSearchPhrase($('input.header-search-text').val().trim()); 

     $('button.lsa-site-searchbtn').data('lsa-collection', optionsPipe);
     if( $('.lsa-site-searchbtn').find('.fa-times').length > 0 ) {
        resetSearchButtons();
     } 
     return false;
  });

  setTimeout(function() {
    if (!nativeDataList && pathName !== undefined) {
      jQuery('head').append('<link rel="stylesheet" href="/etc/designs/michigan-lsa/clientlibs/jquery-ui/jquery-ui.min.css" type="text/css" />');

      jQuery.getScript("/etc/designs/michigan-lsa/clientlibs/jquery-ui/jquery-ui.min.js")
        .done(function() {
          searchGatewayInput.autocomplete({
            source: function(request, response) {
              var results = $.ui.autocomplete.filter(searchTerms, request.term);
              response(results.slice(0, 5));
            }
          });
        });
    }
  }, 2500);

  function lsaEscapeBbqSearchString(str){
    return str
      .replace(/&/g, '')
      .replace(/>/g, '')
      .replace(/</g, '')
      .replace(/"/g, '')
      .replace(/%/g, '');
  }

}); // closing on ready function

//global scope

function lsaSearchResultClickHandler(event){
  event.preventDefault(); 
  event.stopPropagation();   
  var selfBtn = $(event.target);
  console.log(event)
  if( typeof ga === "undefined"){
    // escape early if no tracking
    if  (typeof selfBtn[0] != 'undefined'){
      if (selfBtn[0].target == "_blank"){
        window.open(selfBtn[0].href, '_blank');
      } else {
        location = selfBtn[0].href;
      }          
      selfBtn = {};
    }
    return;
  } // else continue     
  ga('send', {
    hitType: 'event',
    eventCategory: 'Search Result',
    eventAction: 'click',
    eventLabel: selfBtn[0].href,
  });
  ga('newTracker.send', {
    hitType: 'event',
    eventCategory: 'Search Result',
    eventAction: 'click',
    eventLabel: selfBtn[0].href,
    hitCallback: createFunctionWithTimeout(function() {
      if  (typeof selfBtn[0] != 'undefined'){
        if (selfBtn[0].target == "_blank"){
          window.open(selfBtn[0].href, '_blank');
        } else {
          location = selfBtn[0].href;
        }          
        selfBtn = {};
      }
    }),
  });
}

function createFunctionWithTimeout(callback, opt_timeout) {
  var called = false;
  setTimeout(callback, opt_timeout || 1000);
  return function() {
    if (!called) {
      called = true;
      callback();
    }
  }
}



$(function(){

  function send_message_to_sw(msg){
      return new Promise(function(resolve, reject){
          // Create a Message Channel
          var msg_chan = new MessageChannel();
          // Handler for recieving message reply from service worker
          msg_chan.port1.onmessage = function(event){
              if(event.data.error){
                  reject(event.data.error);
              } else {
                  resolve(event.data);
              }
          };
          // Send message to service worker along with port for reply
          if(navigator.serviceWorker.controller){
            navigator.serviceWorker.controller.postMessage(msg, [msg_chan.port2]);
          }
      });
  }

  var $vueRoot = $("#vue-header-root-container")
  // register service worker
  // see google-analytics-snippet for LSADNTNotSet
  if ('serviceWorker' in navigator && $vueRoot.data("lsaServiceworker") === true && LSADNTNotSet) {
    window.addEventListener('load', function() {
      navigator.serviceWorker.register('/swlsav1.js').then(function(registration) {
        // Registration was successful
        console.log('ServiceWorker registration successful with scope: ', registration.scope);
      }, function(err) {
        // registration failed :(
        console.log('ServiceWorker registration failed: ', err);
      });
    });
  } 
})



/*  
// U-M LSA Confidential
// for ALL wcmmodes
// on page load
//  for every list component $('.lsa-list-overlay') on the page 
//    find the pagination next button and register click handler
//        when clicked, use ajax to fetch new list from the href 
//        replace entire content of the list #listid.lsa-list-overlay 
//        this will update pagination links 
//        register new click handlers 


*/




$(function(){
    var fetchNewList = function(url, $list){
        $.get( url, function( data ) {
          $list.replaceWith( data );
          registerListPagination();
        });
    }

    var registerListPagination = function(){
        $(".cq-dd-pages.lsa-list-overlay .lsa-pagination a").click(function(event){
            event.preventDefault();
            event.stopPropagation();
            fetchNewList($(this).attr('href'), $(this).closest(".cq-dd-pages.lsa-list-overlay"));
        });
    }

    registerListPagination();

});


// $(document).ready(
//     function() {    
//         var self = {};
//         var currentState = null;
//         var _extractObject = function(queryString) {
//             var params = queryString.split("&");
//             var paramObj = { };

//             for (var idx = 0 ; idx < params.length ; idx++) {
//                 var param = params[idx];
//                 var paramInfo = param.split("=");
//                 if (paramInfo.length >= 2) {
//                     paramObj[paramInfo[0]] = paramInfo[1];
//                 }
//             }
//             return paramObj;
//         }

//         var _combineQueryStrings = function(queryString1, queryString2) {
//             var paramObj1 = _extractObject(queryString1);
//             var paramObj2 = _extractObject(queryString2);

//             for (var param in paramObj2) {
//                 paramObj1[param] = paramObj2[param];
//             }

//             var combinedQueryString = "";

//             for (var param in paramObj1) {
//                 if (combinedQueryString != "") {
//                     combinedQueryString += "&";
//                 }
//                 combinedQueryString += param + "=" + paramObj1[param];
//             }

//             return combinedQueryString;
//         };

//         self.linkClick = function(element, listId) {
//             var goToLink = element.href;
//             var urlRegex = /https?:\/\/[^\\/]*(.*)/gi;
//             var matches = urlRegex.exec(goToLink);
//             var queryString = "";

//             if (matches && matches.length > 0) {
//                 var linkPath = matches[1];
//                 var queryIdx = linkPath.indexOf("?");
//                 if (queryIdx >= 0) {
//                     queryString = linkPath.substring(queryIdx + 1);
//                 }
//             }

//             // do XHR to load list
//             var  xhr = new XMLHttpRequest();
//             xhr.onreadystatechange = function() {
//                 if (xhr.readyState == 4
//                     && xhr.status == 200
//                     && xhr.responseText != "") {
//                     var targetList = document.getElementById(listId);
//                     if (targetList) {

//                         if (!window.history.state) {
//                             window.history.replaceState({
//                                 listId: listId,
//                                 content: targetList.outerHTML
//                             }, null, window.location.href);
//                         }

//                         if (currentState
//                                 && currentState.listId != listId) {
//                             currentState["extraListId"] = listId;
//                             currentState["extraContent"] = targetList.outerHTML;
//                             window.history.replaceState(currentState, null, window.location.href);
//                         }

//                         targetList.outerHTML = xhr.responseText;

//                         // focus first item of the new list
//                         var newTargetList = document.getElementById(listId);
//                         var firstListItem = newTargetList.getElementsByTagName("li")[0];
//                         var anchors = firstListItem.getElementsByTagName("a");
//                         if (anchors.length === 0) {
//                             // fall back: no anchor in first list item; focus li itself
//                             firstListItem.setAttribute("tabindex", "0");
//                             firstListItem.focus();
//                         } else {
//                             // default: select anchor in first list item
//                             anchors[0].focus();
//                         }

//                         var stateContent = xhr.responseText;
//                         var currentUrl = window.location.href;
//                         var currentQueryString = "";
//                         var queryIdx = currentUrl.indexOf("?");
//                         if (queryIdx >= 0) {
//                             currentQueryString = currentUrl.substring(queryIdx + 1);
//                             currentUrl = currentUrl.substring(0, queryIdx);
//                         }

//                         var useQueryString = _combineQueryStrings(currentQueryString, queryString);

//                         currentState = {
//                             listId: listId,
//                             content: stateContent
//                         };

//                         window.history.pushState(currentState, null, currentUrl + "?" + useQueryString);
//                     }
//                 }
//             }
//             xhr.open("GET", goToLink, true);
//             xhr.send();
//             return false;
//         };

//         var _updateList = function (listId, content) {
//             var targetList = document.getElementById(listId);
//             if (targetList) {
//                 targetList.outerHTML = content;
//             }
//         }

//         self.handlePopStateListNavigation = function(event) {
//             if (event.state) {
//                 _updateList(event.state.listId, event.state.content);
//                 if (event.state.extraListId) {
//                     _updateList(event.state.extraListId, event.state.extraContent);
//                 }
//             }
//         };

//         self.bindHistoryPopStateEvent = function() {
//             if (window.addEventListener) {
//                 window.addEventListener("popstate", CQ.WCM.List.handlePopStateListNavigation);
//             } else if (window.attachEvent) {
//                 window.attachEvent("popstate", CQ.WCM.List.handlePopStateListNavigation);
//             }
//         };

//     })


$(function(){    
    var vidWrapper = $('.video-banner-wrap');
    if(vidWrapper.length != 0 ){      
      vidWrapper.find('.video-play').on('click', playVideo);
      vidWrapper.find('.video-pause').on('click', pauseVideo);
    }
});

var playVideo = function(element){
  var vidWrapper = $('.video-banner-wrap');  
  $(this).hide();
  vidWrapper.find('.video-pause').show();
  vidWrapper.find('.bg-video-viewport video').get(0).play();
}

var pauseVideo = function(element){
  var vidWrapper = $('.video-banner-wrap');  
  $(this).hide();
  vidWrapper.find('.video-play').show();
  vidWrapper.find('.bg-video-viewport video').get(0).pause();
}

$(window).load(function(){
	$( ".carousel-inner .item" ).each(function( index ) { //iterate through every slide
        $( ".caption", this ).css("height", 'auto'); //get natural height
    });
    
    $('.carousel').swiperight(function() {
        $('.carousel').carousel('prev');
    });

    $('.carousel').swipeleft(function() {
        $('.carousel').carousel('next');        
    });

    $('.carousel').on('slide.bs.carousel', function (eve) {
       var nextImage = $(eve.relatedTarget).find('div.lsa-slide-pict');
        if( nextImage.find('img').length == 0){
            loadSmartImage(nextImage);         
        }
   });
});

$(window).resize(function() {
    $( ".carousel-inner .item" ).each(function( index ) { //iterate through every slide
        $( ".caption", this ).css("height", 'auto'); //get natural height
    });
});

var loadSmartImage = function(ele){
    $(ele).attr('data-picture' , 'data-picture');
    picturefill();
}

$( document ).ready(function() {
	if ( $("ol.sidenav li.third").length <= 0) {
		$("ol.sidenav li.second.active").removeClass("kids");
    }
	
    $( "ol.sidenav a.disabled" ).click(function(e) {
		e.preventDefault();
	});
});
$(document).ready(function() {
    // $('.people.equalHeight').each(function() {
    //     $(this).children('.matchHeight').matchHeight(true);
    // });

    // swicthed directory view to gallery
    $("a.gallery:not(.disabled)").click(function(e){ 
      e.preventDefault();
      // var href  = location.href;
      var search = location.search;
      var hash = ""; //location.hash;
      var path = location.pathname;
      if (path.indexOf(".directory.html") > -1 ){
        path = path.replace(".directory.html",".gallery.html");
      } else {
        path = path.replace(".html",".gallery.html");
      }
      // directory uses search, gallery uses hash
      if (search){
        hash = search.replace("?","#");
      }
      console.log(path);
      console.log(search);

      var gallery =  path + hash;
      console.log("gallery"); 
      console.log(gallery);      
      window.location = gallery;
      
    });

    $("a.directory:not(.disabled)").click(function(e){ 
      e.preventDefault();
      // var href  = location.href;
      var hash = location.hash;
      var search = ""; //location.hash;
      var path = location.pathname;
      if (path.indexOf(".gallery.html") > -1 ){
        path = path.replace(".gallery.html",".directory.html");
      } else {
        path = path.replace(".html",".directory.html");
      }
      // directory uses search, gallery uses hash
      if (hash){
        search = hash.replace("#","?");
      }
      console.log(path);
      console.log(search);

      var directory =  path + search;
      console.log("directory"); 
      console.log(directory);      
      window.location = directory;
      
    });

    $('.directory-view li a').click(function(e){
      e.preventDefault();
      e.stopPropagation();
      var tag = $(this).data("tag-name");
      var tagns = $(this).data("tag-namespace");
      var tagText = $(this).data("tag-text");
      window.location.search = "tagns="+tagns+"&tag="+tag+"&tagtext="+tagText
    });

    if (window.location.search.indexOf("tag") > -1){
      var searchStr = window.location.search;
      var searchRX = /.+tag=([^&]+)/;
      var tagTextRegex = /.+tagtext=([^&]+)/;
      var matchesTag = searchRX.exec(searchStr);
      var matchesTagText = tagTextRegex.exec(searchStr);

      if(matchesTag !== null || matchesTagText !== null){
        $('.directory-view i.fa-chevron-down').hide();
        $('.directory-view i.fa-times').show()
          .parent().unbind()
          .attr('href', window.location.pathname)
          .attr('onclick', "");

        if (matchesTagText !== null && matchesTagText.length == 2){
         $('.dropdown-tags .filter-label').text("Filtered: " + decodeURIComponent(matchesTagText[1].replace(/\+/g, ' ')));
         $('.directory-view .dropdown.text').removeClass('dropdown')
        } else if (matchesTag !== null && matchesTag.length == 2) {
         $('.dropdown-tags .filter-label').text("Filtered: " + matchesTag[1]);
         $('.directory-view .dropdown.text').removeClass('dropdown')
        }
      }
    }

    var convertHashToSearchAndRedirect = function(){
      var hash = location.hash;
      var search = ""; 
      var path = location.pathname;
      var peoplelistDirEle = $(".people-directory-wrap");
      

      if (hash.indexOf("tag") > -1 && peoplelistDirEle.length > 0){
        search = hash.replace("#","?");
        console.log(path);
        console.log(search);

        var directory =  path + search;
        console.log("directory"); 
        console.log(directory);  
        
        window.location = directory;          
      }
          
    }

    convertHashToSearchAndRedirect();
});
var currentPage = 1;
var itemsToSkip = $('div.news-archive-wrap').data('lsa-numbertoskip');
var numToShow = $('div.news-archive-wrap').data('lsa-numbertoshow');
var resourcePath = $('div.news-archive-wrap').data('lsa-resourcepath');
if (itemsToSkip == 0) itemsToSkip == 2
if (numToShow == 0) numToShow = 5;

function getNews() {
    $('#archive-list').html('<h3 class="loading-people"><i class="fa fa-circle-o-notch fa-spin" ></i></h3>');

    $.get(resourcePath+".story.html/" + currentPage + ".html", function (data) {

        if (data != null && data != '') {
            $('#archive-list').html(data);
        } else if (data <= numToShow) {
            $('.news-archive-wrap .footline .more').css('visibility', 'hidden');
        } else {
            $('#archive-list').html('There are currently no articles in the news archive.');
            $('.news-archive-wrap .footline').css('visibility', 'hidden');
        }

        var totalResults = $('#archive-list .story').first().attr('data-total-results');
        var compNum = (itemsToSkip + (currentPage * numToShow));

        if (compNum == 0 || (totalResults <= numToShow)) {
          $('.news-archive-wrap .footline').css('visibility', 'hidden');
        } else {
          if (totalResults <= compNum) {
                $('.news-archive-wrap a.next').addClass("inactive");
            } else {
                $('.news-archive-wrap a.next').removeClass("inactive");
            }
        }

        if(totalResults === undefined){
            $('#archive-list').html('<p>There are currently no related articles in the archive.</p>');
            $('.news-archive-wrap .footline').css('visibility', 'hidden');
        }
    }).fail(function(){        
        var message = "";
        if(document.cookie.indexOf("wcmmode=edit") > -1 || (typeof CQ !== "undefined" && typeof CQ.WCM !== "undefined" && CQ.WCM.isEditMode(true) ))  {
            message = "Please edit the News Archive or Feed and click OK";
            $('#archive-list').html('<p>'+ message + '</p>');
          } else {
            $('.news-archive-wrap').remove();
          }        
    });
}

$(document).ready(function () {
    if($('div.news-archive-wrap').length !=0){
        $('.news-archive-wrap .tags a').on('click', function () {

            if ($('.news-archive-wrap .tags').hasClass('open')) {
                $(".news-archive-wrap .tags").removeClass('open');
                $(".news-archive-wrap .tags .dropdown").hide();
            } else {
                $('.news-archive-wrap .tags').addClass('open');
                $(".news-archive-wrap .tags .dropdown").show();
            }
        });

        $(".news-archive-wrap .tags").hoverIntent( function() {}, function() {
            $(".news-archive-wrap .tags").removeClass('open');
            $(".news-archive-wrap .tags .dropdown").hide();
        });

        $('.news-archive-wrap a.previous').addClass("inactive");

        $('.news-archive-wrap a.next').on('click', function () {

            if ( $('.news-archive-wrap a.next').hasClass("inactive") )
                return false;

            currentPage++;

            if (currentPage > 1)
                $('.news-archive-wrap a.previous').removeClass("inactive");

            getNews();
            return false;
        });

        $('.news-archive-wrap a.previous').on('click', function () {

            if ( $('.news-archive-wrap a.previous').hasClass("inactive") )
                return false;

            currentPage--;
            if (currentPage == 1)
                $('.news-archive-wrap a.previous').addClass("inactive");

            getNews();
            return false;
        });
    
        getNews();
    }
});

$(window).load(function(){


//the background images natural size is 1440 x 500, aspect ratio= 2.88
// when the section aspect ration > 2.88
//    the image height is greater than the section height and change image position Y will not reveal background color
// when the section aspect ration <= 2.88
//    the image height and section height are the same, changing the position-y will show background color behind image

  var $window = $(window);
  $("section[data-lsa-parallax='parallax']").each(function(index){
    // Variables
    var $bgobj = $(this); // assigning the object
    var imgSrc = $bgobj.data("imageSrc");
    var image = new Image();
    var viewHeight, rect, scale, scaledHeight, heightDiff, sectionWidth, sectionHeight, sectionAspect, imageAspect, sectionAbsY;
    var parallaxSpeed = 1, backgroundPositionY = 0, scrollPosition = $(window).scrollTop();
    var docEl = document.documentElement;
    parallaxSpeed = $bgobj.data("lsa-parallax-speed") / 10;
    var initialImgPosition = $bgobj.data("lsa-parallax-position");
    var positionDelta = 0;
    var bgpStr = "";
    var rendering = false;
    image.src = imgSrc;

    // Functions
    function checkVisible($elm) {
      var elm = $elm[0];
      if(elm == undefined){
        return false;
      }
      return !(rect.bottom < 0 || rect.top - viewHeight >= 0); // partially visible      
    }

    var updateImagePosition = function(){
      rendering = false;
      if(backgroundPositionY == positionDelta){
        bgpStr = "background-position-y: "+Math.ceil(backgroundPositionY)+"px;";
        $bgobj.attr("style",bgpStr);
      }
    }

    function setScaleVariables($element){

      viewHeight = Math.max(document.documentElement.clientHeight, window.innerHeight);
      rect = $bgobj[0].getBoundingClientRect();
      imageAspect = image.width / image.height;
      sectionAbsY = rect.top + window.pageYOffset - docEl.clientTop;
      sectionWidth = $bgobj.outerWidth();
      sectionHeight = $bgobj.outerHeight();
      // figure out how much the image is scaled
      scale = sectionWidth / image.width;
      scaledHeight = scale * image.height;
      // get the difference b/w scaled height and section height
      heightDiff = scaledHeight - sectionHeight;
      sectionAspect = sectionWidth / sectionHeight;

      if (initialImgPosition == "top"){
        backgroundPositionY = 0;
      } else if (initialImgPosition == "center"){
        backgroundPositionY = -0.5 * heightDiff;
      } else if (initialImgPosition == "bottom"){
        backgroundPositionY = -1 * heightDiff;
      } else {
        backgroundPositionY = 0;
      }
      requestFrameUpdate();
    }
    
    // Initialize
    setScaleVariables($bgobj);
    
    // Event Handlers
    $(window).resize(function(){
      $("section[data-lsa-parallax='parallax']").each(function(){
        setScaleVariables($(this));
      });      
    });

    function requestFrameUpdate() {
      if(!rendering ) {
        requestAnimationFrame(updateImagePosition);
      }
      rendering = true;
    }

    $(window).scroll(function(event) {

      var scrollingDown = true;
      var scrollDiff = Math.abs($window.scrollTop() - scrollPosition);

      if(scrollPosition < $window.scrollTop()){
        scrollingDown = true;        
      } else {
        scrollingDown = false;
      }

      scrollPosition = $window.scrollTop();      

      rect = $bgobj[0].getBoundingClientRect();
      if ( sectionAspect <= imageAspect || !checkVisible($bgobj)){        
        return;
      } 
      // get the scroll amount relative to the top of the section
      // are they scrolling up or down
      //  if scrolling down the page and the abs-value of backgroundPositionY < heightDiff then subtract
      positionDelta = 0;
      bgpStr = "";
      if(scrollingDown){ //SCROLLING DOWN
          positionDelta = backgroundPositionY - (scrollDiff * parallaxSpeed);          
          if(Math.abs(positionDelta) <= heightDiff) {
            backgroundPositionY = positionDelta;
          }       
      } else { //SCROLLING UP
          positionDelta = backgroundPositionY + (scrollDiff * parallaxSpeed);
          if(positionDelta < 0) {
            backgroundPositionY = positionDelta;
          }
      }
      requestFrameUpdate();       
      
    });
  }); 
});




$(document).ready(function(){

  $('.lsa_events_manual,.lsa_events_happening').click(function(e){
    e.preventDefault();
    e.stopPropagation();
    console.log("fire");
    $('.happeningEvents,.manualEvents').toggleClass('show').toggleClass('hide');
    $('.lsa_events_manual,.lsa_events_happening').toggleClass('active');
  });

});

$(document).ready(function() {
    $('.highlighted-work-wrap .equalHeight').each(function() {
        $(this).children('.matchHeight').matchHeight(true);
    });
});
$('.fourBtn').hover(function() { 
  var btnElement = $(this);
  if(btnElement.data('color') != undefined && btnElement.data('hover') != undefined ) { // has both
    btnElement.toggleClass(btnElement.data('color')).toggleClass(btnElement.data('hover')); 
  } else if (btnElement.data('color') == undefined && btnElement.data('hover') != undefined ){ //has hover only
    btnElement.toggleClass(btnElement.data('hover'));
  }
  
});


$(document).ready(function () {

    $('.calendar .tags a').on('click', function () {

        if ($('.calendar .tags').hasClass('open')) {
            $(".calendar .tags").removeClass('open');
            $(".calendar .tags .dropdown").hide();
        } else {
            $('.calendar .tags').addClass('open');
            $(".calendar .tags .dropdown").show();
        }
    });

    $(".calendar .tags").hoverIntent( function() {}, function() {
        $(".calendar .tags").removeClass('open');
        $(".calendar .tags .dropdown").hide();
    });
    
 //    $(document).ready(function() {
	//     if ( $(".events_calendar").length > 0) {
	// 		$(".breadcrumb-wrap a.disabled").removeClass("disabled themeText").addClass("enabled").off('click').parent().removeClass("active");
	// 		var pageName = $(".pageTitle h2").text();
	// 		$("ol.breadcrumb.hidden-xs").append( "<li><span class=\"themeText\">"+pageName+"</span></li>" );
	// 		$("ol.breadcrumb.closed .themeText").text(pageName);
	// 		$("ol.breadcrumb.open ol.inner").append( "<li><span class=\"themeText\">"+pageName+"</span></li>" );
			
	// 		$("ol.sidenav li.second a.disabled").removeClass("disabled").off('click')
	//     }
	// });
});
$(document).ready(function () {
    $('.dropdown-tags a').on('click', function () {

        if ($('.dropdown-tags').hasClass('open')) {
            $(".dropdown-tags").removeClass('open');
            $(".dropdown-tags .dropdown").hide();
        } else {
            $('.dropdown-tags').addClass('open');
            $(".dropdown-tags .dropdown").show();
        }
    });

    $(".dropdown-tags").hoverIntent( function() {}, function() {
        $(".dropdown-tags").removeClass('open');
        $(".dropdown-tags .dropdown").hide();
    });
});
$( document ).ready(function() {
  $( ".elipsis" ).click(function() {
    $( ".breadcrumb.open" ).slideToggle( "fast", function() { });
    $( ".breadcrumb.closed" ).slideToggle( "fast", function() { });
    return false;
  });
  $( ".breadcrumb-wrap a.disabled" ).click(function(e) {
	  e.preventDefault();
  });
});
function loadGalleryPage(gallery, start, end) {
	var items = $('.item', gallery);
	$(items).hide();
	for (i = start; i < end; i++) { 
		if ( $(items[i]).hasClass('loaded') || items[i] == null ) {
			$(items[i]).show();
		} else {
			$('img', items[i]).attr('src', $('img', items[i]).attr('data-src'));
			$(items[i]).addClass('loaded').show();	
		}
	}
	picturefill();
}

$(document).ready(function () {

	$(".asset-gallery-wrap .gallery").each(function( i ) {
		if ( parseInt($(this).attr('data-page-size')) >= parseInt($(this).attr('data-total-results')) ) {
			$(this).closest('.asset-gallery-wrap').find('.lsa-pagination .next').addClass('inactive');
		}
		loadGalleryPage(this , 0, parseInt( $(this).attr('data-page-size') ));
	});

	$('.asset-gallery-wrap .lsa-pagination .previous').click(function(e) {
		if ( $(this).hasClass('inactive') ) {
			return false;
		}
		e.preventDefault();
		var gallery = $(this).closest('.asset-gallery-wrap').children('.gallery');
		var page = parseInt( $(gallery).attr('data-page') ) - 1;
		$(gallery).attr('data-page', page);
		var pageSize = parseInt( $(gallery).attr('data-page-size') );
		loadGalleryPage( gallery, (page*pageSize)-pageSize , page*pageSize);
		if ( page <= 1 ) {
			$(this).addClass('inactive');
		}
		$(this).parent().children('.next').removeClass('inactive');
	});
	
	$('.asset-gallery-wrap .lsa-pagination .next').click(function(e) {		
		if ( $(this).hasClass('inactive') ) {
			return false;
		}
		e.preventDefault();
		var gallery = $(this).closest('.asset-gallery-wrap').children('.gallery');
		var page = parseInt( $(gallery).attr('data-page') ) + 1; //
		$(gallery).attr('data-page', page); // update page attr
		var pageSize = parseInt( $(gallery).attr('data-page-size') ); // could be 1,2, 4, 16
		loadGalleryPage( gallery, (page*pageSize)-pageSize , page*pageSize);
		// page 2 >= 6/4 (1.5, so ceil makes it 2, so true) 
		if ( page >= Math.ceil( $(gallery).attr('data-total-results')/pageSize ) ) {
			$(this).addClass('inactive');
		}
		$(this).parent().children('.previous').removeClass('inactive');
	});

	$(this).parent().children('.previous').addClass('inactive');

	$('.preview-mode-link').click(function() {
	  if($('.aem-AuthorLayer-Preview').length) {
	    var $this = $(this);
	    $this.removeAttr("data-lightbox");
	    $this.removeAttr("href");
	    var header = 'Info';
	    var content =  'To view asset gallery, select "View as Published" option present in the "Page Information" menu located at top left corner of the screen.';
        parent.CustomLsaAlert.showAlert(header, content);
      }
	});
});
$(document).ready(function () {
    $('.rib').on('click', function () {
        var body = $(this).next('.accordion-body');

        $(body).slideToggle( "fast", function() { });
        var selfAccordion = $(this).toggleClass( "open" );
        if( typeof ga !== "undefined"){
          ga('send', {
            hitType: 'event',
            eventCategory: 'Accordion',
            eventAction: 'click',
            eventLabel: selfAccordion.text(),
          });

          ga('newTracker.send', {
            hitType: 'event',
            eventCategory: 'Accordion',
            eventAction: 'click',
            eventLabel: selfAccordion.text(),          
          });
        }
    });
})
/* 
 * From: https://github.com/benschwarz/matchMedia.js/blob/IE7-8/matchMedia.js
 * R2i - Small Modification to currWidth to work in IE8
 * 
 */

/*! matchMedia() polyfill - Test a CSS media type/query in JS. Authors & copyright (c) 2012: Scott Jehl, Paul Irish, Nicholas Zakas. Dual MIT/BSD license */

window.matchMedia = window.matchMedia || (function(doc, undefined){

  var docElem  = doc.documentElement,
      refNode  = docElem.firstElementChild || docElem.firstChild,
      // fakeBody required for <FF4 when executed in <head>
      fakeBody = doc.createElement('body'),
      div      = doc.createElement('div');

  div.id = 'mq-test-1';
  div.style.cssText = "position:absolute;top:-100em";
  fakeBody.style.background = "none";
  fakeBody.appendChild(div);

  var mqRun = function ( mq ) {
    div.innerHTML = '&shy;<style media="' + mq + '"> #mq-test-1 { width: 42px; }</style>';
    docElem.insertBefore( fakeBody, refNode );
    bool = div.offsetWidth === 42;
    docElem.removeChild( fakeBody );
    
    return { matches: bool, media: mq };
  },
  
  getEmValue = function () {
    var ret,
        body = docElem.body,
        fakeUsed = false;

    div.style.cssText = "position:absolute;font-size:1em;width:1em";

    if( !body ) {
      body = fakeUsed = doc.createElement( "body" );
      body.style.background = "none";
    }

    body.appendChild( div );

    docElem.insertBefore( body, docElem.firstChild );

    if( fakeUsed ) {
      docElem.removeChild( body );
    } else {
      body.removeChild( div );
    }
    
    //also update eminpx before returning
    ret = eminpx = parseFloat( div.offsetWidth );

    return ret;
  },
  
  //cached container for 1em value, populated the first time it's needed 
  eminpx,
  
  // verify that we have support for a simple media query
  mqSupport = mqRun( '(min-width: 0px)' ).matches;

  return function ( mq ) {
    if( mqSupport ) {
      return mqRun( mq );
    } else {
      var min = mq.match( /\(min\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/ ) && parseFloat( RegExp.$1 ) + ( RegExp.$2 || "" ),
          max = mq.match( /\(max\-width[\s]*:[\s]*([\s]*[0-9\.]+)(px|em)[\s]*\)/ ) && parseFloat( RegExp.$1 ) + ( RegExp.$2 || "" ),
          minnull = min === null,
          maxnull = max === null,
          currWidth = doc.body ? doc.body.offsetWidth : 0,
          em = 'em';
      
      if( !!min ) { min = parseFloat( min ) * ( min.indexOf( em ) > -1 ? ( eminpx || getEmValue() ) : 1 ); }
      if( !!max ) { max = parseFloat( max ) * ( max.indexOf( em ) > -1 ? ( eminpx || getEmValue() ) : 1 ); }
      
      bool = ( !minnull || !maxnull ) && ( minnull || currWidth >= min ) && ( maxnull || currWidth <= max );

      return { matches: bool, media: mq };
    }
  };

}( document ));
/* Modernizr 2.8.3 (Custom Build) | MIT & BSD
 * Build: http://modernizr.com/download/#-fontface-backgroundsize-borderimage-flexbox-flexboxlegacy-hsla-opacity-applicationcache-canvas-canvastext-draganddrop-hashchange-history-audio-video-indexeddb-input-inputtypes-localstorage-postmessage-sessionstorage-websockets-websqldatabase-webworkers-geolocation-inlinesvg-smil-svg-svgclippaths-touch-webgl-printshiv-mq-cssclasses-teststyles-testprop-testallprops-hasevent-prefixes-domprefixes-load
 */
;window.Modernizr=function(a,b,c){function D(a){j.cssText=a}function E(a,b){return D(n.join(a+";")+(b||""))}function F(a,b){return typeof a===b}function G(a,b){return!!~(""+a).indexOf(b)}function H(a,b){for(var d in a){var e=a[d];if(!G(e,"-")&&j[e]!==c)return b=="pfx"?e:!0}return!1}function I(a,b,d){for(var e in a){var f=b[a[e]];if(f!==c)return d===!1?a[e]:F(f,"function")?f.bind(d||b):f}return!1}function J(a,b,c){var d=a.charAt(0).toUpperCase()+a.slice(1),e=(a+" "+p.join(d+" ")+d).split(" ");return F(b,"string")||F(b,"undefined")?H(e,b):(e=(a+" "+q.join(d+" ")+d).split(" "),I(e,b,c))}function K(){e.input=function(c){for(var d=0,e=c.length;d<e;d++)u[c[d]]=c[d]in k;return u.list&&(u.list=!!b.createElement("datalist")&&!!a.HTMLDataListElement),u}("autocomplete autofocus list placeholder max min multiple pattern required step".split(" ")),e.inputtypes=function(a){for(var d=0,e,f,h,i=a.length;d<i;d++)k.setAttribute("type",f=a[d]),e=k.type!=="text",e&&(k.value=l,k.style.cssText="position:absolute;visibility:hidden;",/^range$/.test(f)&&k.style.WebkitAppearance!==c?(g.appendChild(k),h=b.defaultView,e=h.getComputedStyle&&h.getComputedStyle(k,null).WebkitAppearance!=="textfield"&&k.offsetHeight!==0,g.removeChild(k)):/^(search|tel)$/.test(f)||(/^(url|email)$/.test(f)?e=k.checkValidity&&k.checkValidity()===!1:e=k.value!=l)),t[a[d]]=!!e;return t}("search tel url email datetime date month week time datetime-local number range color".split(" "))}var d="2.8.3",e={},f=!0,g=b.documentElement,h="modernizr",i=b.createElement(h),j=i.style,k=b.createElement("input"),l=":)",m={}.toString,n=" -webkit- -moz- -o- -ms- ".split(" "),o="Webkit Moz O ms",p=o.split(" "),q=o.toLowerCase().split(" "),r={svg:"http://www.w3.org/2000/svg"},s={},t={},u={},v=[],w=v.slice,x,y=function(a,c,d,e){var f,i,j,k,l=b.createElement("div"),m=b.body,n=m||b.createElement("body");if(parseInt(d,10))while(d--)j=b.createElement("div"),j.id=e?e[d]:h+(d+1),l.appendChild(j);return f=["&#173;",'<style id="s',h,'">',a,"</style>"].join(""),l.id=h,(m?l:n).innerHTML+=f,n.appendChild(l),m||(n.style.background="",n.style.overflow="hidden",k=g.style.overflow,g.style.overflow="hidden",g.appendChild(n)),i=c(l,a),m?l.parentNode.removeChild(l):(n.parentNode.removeChild(n),g.style.overflow=k),!!i},z=function(b){var c=a.matchMedia||a.msMatchMedia;if(c)return c(b)&&c(b).matches||!1;var d;return y("@media "+b+" { #"+h+" { position: absolute; } }",function(b){d=(a.getComputedStyle?getComputedStyle(b,null):b.currentStyle)["position"]=="absolute"}),d},A=function(){function d(d,e){e=e||b.createElement(a[d]||"div"),d="on"+d;var f=d in e;return f||(e.setAttribute||(e=b.createElement("div")),e.setAttribute&&e.removeAttribute&&(e.setAttribute(d,""),f=F(e[d],"function"),F(e[d],"undefined")||(e[d]=c),e.removeAttribute(d))),e=null,f}var a={select:"input",change:"input",submit:"form",reset:"form",error:"img",load:"img",abort:"img"};return d}(),B={}.hasOwnProperty,C;!F(B,"undefined")&&!F(B.call,"undefined")?C=function(a,b){return B.call(a,b)}:C=function(a,b){return b in a&&F(a.constructor.prototype[b],"undefined")},Function.prototype.bind||(Function.prototype.bind=function(b){var c=this;if(typeof c!="function")throw new TypeError;var d=w.call(arguments,1),e=function(){if(this instanceof e){var a=function(){};a.prototype=c.prototype;var f=new a,g=c.apply(f,d.concat(w.call(arguments)));return Object(g)===g?g:f}return c.apply(b,d.concat(w.call(arguments)))};return e}),s.flexbox=function(){return J("flexWrap")},s.flexboxlegacy=function(){return J("boxDirection")},s.canvas=function(){var a=b.createElement("canvas");return!!a.getContext&&!!a.getContext("2d")},s.canvastext=function(){return!!e.canvas&&!!F(b.createElement("canvas").getContext("2d").fillText,"function")},s.webgl=function(){return!!a.WebGLRenderingContext},s.touch=function(){var c;return"ontouchstart"in a||a.DocumentTouch&&b instanceof DocumentTouch?c=!0:y(["@media (",n.join("touch-enabled),("),h,")","{#modernizr{top:9px;position:absolute}}"].join(""),function(a){c=a.offsetTop===9}),c},s.geolocation=function(){return"geolocation"in navigator},s.postmessage=function(){return!!a.postMessage},s.websqldatabase=function(){return!!a.openDatabase},s.indexedDB=function(){return!!J("indexedDB",a)},s.hashchange=function(){return A("hashchange",a)&&(b.documentMode===c||b.documentMode>7)},s.history=function(){return!!a.history&&!!history.pushState},s.draganddrop=function(){var a=b.createElement("div");return"draggable"in a||"ondragstart"in a&&"ondrop"in a},s.websockets=function(){return"WebSocket"in a||"MozWebSocket"in a},s.hsla=function(){return D("background-color:hsla(120,40%,100%,.5)"),G(j.backgroundColor,"rgba")||G(j.backgroundColor,"hsla")},s.backgroundsize=function(){return J("backgroundSize")},s.borderimage=function(){return J("borderImage")},s.opacity=function(){return E("opacity:.55"),/^0.55$/.test(j.opacity)},s.fontface=function(){var a;return y('@font-face {font-family:"font";src:url("https://")}',function(c,d){var e=b.getElementById("smodernizr"),f=e.sheet||e.styleSheet,g=f?f.cssRules&&f.cssRules[0]?f.cssRules[0].cssText:f.cssText||"":"";a=/src/i.test(g)&&g.indexOf(d.split(" ")[0])===0}),a},s.video=function(){var a=b.createElement("video"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('video/ogg; codecs="theora"').replace(/^no$/,""),c.h264=a.canPlayType('video/mp4; codecs="avc1.42E01E"').replace(/^no$/,""),c.webm=a.canPlayType('video/webm; codecs="vp8, vorbis"').replace(/^no$/,"")}catch(d){}return c},s.audio=function(){var a=b.createElement("audio"),c=!1;try{if(c=!!a.canPlayType)c=new Boolean(c),c.ogg=a.canPlayType('audio/ogg; codecs="vorbis"').replace(/^no$/,""),c.mp3=a.canPlayType("audio/mpeg;").replace(/^no$/,""),c.wav=a.canPlayType('audio/wav; codecs="1"').replace(/^no$/,""),c.m4a=(a.canPlayType("audio/x-m4a;")||a.canPlayType("audio/aac;")).replace(/^no$/,"")}catch(d){}return c},s.localstorage=function(){try{return localStorage.setItem(h,h),localStorage.removeItem(h),!0}catch(a){return!1}},s.sessionstorage=function(){try{return sessionStorage.setItem(h,h),sessionStorage.removeItem(h),!0}catch(a){return!1}},s.webworkers=function(){return!!a.Worker},s.applicationcache=function(){return!!a.applicationCache},s.svg=function(){return!!b.createElementNS&&!!b.createElementNS(r.svg,"svg").createSVGRect},s.inlinesvg=function(){var a=b.createElement("div");return a.innerHTML="<svg/>",(a.firstChild&&a.firstChild.namespaceURI)==r.svg},s.smil=function(){return!!b.createElementNS&&/SVGAnimate/.test(m.call(b.createElementNS(r.svg,"animate")))},s.svgclippaths=function(){return!!b.createElementNS&&/SVGClipPath/.test(m.call(b.createElementNS(r.svg,"clipPath")))};for(var L in s)C(s,L)&&(x=L.toLowerCase(),e[x]=s[L](),v.push((e[x]?"":"no-")+x));return e.input||K(),e.addTest=function(a,b){if(typeof a=="object")for(var d in a)C(a,d)&&e.addTest(d,a[d]);else{a=a.toLowerCase();if(e[a]!==c)return e;b=typeof b=="function"?b():b,typeof f!="undefined"&&f&&(g.className+=" "+(b?"":"no-")+a),e[a]=b}return e},D(""),i=k=null,e._version=d,e._prefixes=n,e._domPrefixes=q,e._cssomPrefixes=p,e.mq=z,e.hasEvent=A,e.testProp=function(a){return H([a])},e.testAllProps=J,e.testStyles=y,g.className=g.className.replace(/(^|\s)no-js(\s|$)/,"$1$2")+(f?" js "+v.join(" "):""),e}(this,this.document),function(a,b){function l(a,b){var c=a.createElement("p"),d=a.getElementsByTagName("head")[0]||a.documentElement;return c.innerHTML="x<style>"+b+"</style>",d.insertBefore(c.lastChild,d.firstChild)}function m(){var a=s.elements;return typeof a=="string"?a.split(" "):a}function n(a){var b=j[a[h]];return b||(b={},i++,a[h]=i,j[i]=b),b}function o(a,c,d){c||(c=b);if(k)return c.createElement(a);d||(d=n(c));var g;return d.cache[a]?g=d.cache[a].cloneNode():f.test(a)?g=(d.cache[a]=d.createElem(a)).cloneNode():g=d.createElem(a),g.canHaveChildren&&!e.test(a)&&!g.tagUrn?d.frag.appendChild(g):g}function p(a,c){a||(a=b);if(k)return a.createDocumentFragment();c=c||n(a);var d=c.frag.cloneNode(),e=0,f=m(),g=f.length;for(;e<g;e++)d.createElement(f[e]);return d}function q(a,b){b.cache||(b.cache={},b.createElem=a.createElement,b.createFrag=a.createDocumentFragment,b.frag=b.createFrag()),a.createElement=function(c){return s.shivMethods?o(c,a,b):b.createElem(c)},a.createDocumentFragment=Function("h,f","return function(){var n=f.cloneNode(),c=n.createElement;h.shivMethods&&("+m().join().replace(/\w+/g,function(a){return b.createElem(a),b.frag.createElement(a),'c("'+a+'")'})+");return n}")(s,b.frag)}function r(a){a||(a=b);var c=n(a);return s.shivCSS&&!g&&!c.hasCSS&&(c.hasCSS=!!l(a,"article,aside,dialog,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}mark{background:#FF0;color:#000}template{display:none}")),k||q(a,c),a}function w(a){var b,c=a.getElementsByTagName("*"),d=c.length,e=RegExp("^(?:"+m().join("|")+")$","i"),f=[];while(d--)b=c[d],e.test(b.nodeName)&&f.push(b.applyElement(x(b)));return f}function x(a){var b,c=a.attributes,d=c.length,e=a.ownerDocument.createElement(u+":"+a.nodeName);while(d--)b=c[d],b.specified&&e.setAttribute(b.nodeName,b.nodeValue);return e.style.cssText=a.style.cssText,e}function y(a){var b,c=a.split("{"),d=c.length,e=RegExp("(^|[\\s,>+~])("+m().join("|")+")(?=[[\\s,>+~#.:]|$)","gi"),f="$1"+u+"\\:$2";while(d--)b=c[d]=c[d].split("}"),b[b.length-1]=b[b.length-1].replace(e,f),c[d]=b.join("}");return c.join("{")}function z(a){var b=a.length;while(b--)a[b].removeNode()}function A(a){function g(){clearTimeout(d._removeSheetTimer),b&&b.removeNode(!0),b=null}var b,c,d=n(a),e=a.namespaces,f=a.parentWindow;return!v||a.printShived?a:(typeof e[u]=="undefined"&&e.add(u),f.attachEvent("onbeforeprint",function(){g();var d,e,f,h=a.styleSheets,i=[],j=h.length,k=Array(j);while(j--)k[j]=h[j];while(f=k.pop())if(!f.disabled&&t.test(f.media)){try{d=f.imports,e=d.length}catch(m){e=0}for(j=0;j<e;j++)k.push(d[j]);try{i.push(f.cssText)}catch(m){}}i=y(i.reverse().join("")),c=w(a),b=l(a,i)}),f.attachEvent("onafterprint",function(){z(c),clearTimeout(d._removeSheetTimer),d._removeSheetTimer=setTimeout(g,500)}),a.printShived=!0,a)}var c="3.7.0",d=a.html5||{},e=/^<|^(?:button|map|select|textarea|object|iframe|option|optgroup)$/i,f=/^(?:a|b|code|div|fieldset|h1|h2|h3|h4|h5|h6|i|label|li|ol|p|q|span|strong|style|table|tbody|td|th|tr|ul)$/i,g,h="_html5shiv",i=0,j={},k;(function(){try{var a=b.createElement("a");a.innerHTML="<xyz></xyz>",g="hidden"in a,k=a.childNodes.length==1||function(){b.createElement("a");var a=b.createDocumentFragment();return typeof a.cloneNode=="undefined"||typeof a.createDocumentFragment=="undefined"||typeof a.createElement=="undefined"}()}catch(c){g=!0,k=!0}})();var s={elements:d.elements||"abbr article aside audio bdi canvas data datalist details dialog figcaption figure footer header hgroup main mark meter nav output progress section summary template time video",version:c,shivCSS:d.shivCSS!==!1,supportsUnknownElements:k,shivMethods:d.shivMethods!==!1,type:"default",shivDocument:r,createElement:o,createDocumentFragment:p};a.html5=s,r(b);var t=/^$|\b(?:all|print)\b/,u="html5shiv",v=!k&&function(){var c=b.documentElement;return typeof b.namespaces!="undefined"&&typeof b.parentWindow!="undefined"&&typeof c.applyElement!="undefined"&&typeof c.removeNode!="undefined"&&typeof a.attachEvent!="undefined"}();s.type+=" print",s.shivPrint=A,A(b)}(this,document),function(a,b,c){function d(a){return"[object Function]"==o.call(a)}function e(a){return"string"==typeof a}function f(){}function g(a){return!a||"loaded"==a||"complete"==a||"uninitialized"==a}function h(){var a=p.shift();q=1,a?a.t?m(function(){("c"==a.t?B.injectCss:B.injectJs)(a.s,0,a.a,a.x,a.e,1)},0):(a(),h()):q=0}function i(a,c,d,e,f,i,j){function k(b){if(!o&&g(l.readyState)&&(u.r=o=1,!q&&h(),l.onload=l.onreadystatechange=null,b)){"img"!=a&&m(function(){t.removeChild(l)},50);for(var d in y[c])y[c].hasOwnProperty(d)&&y[c][d].onload()}}var j=j||B.errorTimeout,l=b.createElement(a),o=0,r=0,u={t:d,s:c,e:f,a:i,x:j};1===y[c]&&(r=1,y[c]=[]),"object"==a?l.data=c:(l.src=c,l.type=a),l.width=l.height="0",l.onerror=l.onload=l.onreadystatechange=function(){k.call(this,r)},p.splice(e,0,u),"img"!=a&&(r||2===y[c]?(t.insertBefore(l,s?null:n),m(k,j)):y[c].push(l))}function j(a,b,c,d,f){return q=0,b=b||"j",e(a)?i("c"==b?v:u,a,b,this.i++,c,d,f):(p.splice(this.i++,0,a),1==p.length&&h()),this}function k(){var a=B;return a.loader={load:j,i:0},a}var l=b.documentElement,m=a.setTimeout,n=b.getElementsByTagName("script")[0],o={}.toString,p=[],q=0,r="MozAppearance"in l.style,s=r&&!!b.createRange().compareNode,t=s?l:n.parentNode,l=a.opera&&"[object Opera]"==o.call(a.opera),l=!!b.attachEvent&&!l,u=r?"object":l?"script":"img",v=l?"script":u,w=Array.isArray||function(a){return"[object Array]"==o.call(a)},x=[],y={},z={timeout:function(a,b){return b.length&&(a.timeout=b[0]),a}},A,B;B=function(a){function b(a){var a=a.split("!"),b=x.length,c=a.pop(),d=a.length,c={url:c,origUrl:c,prefixes:a},e,f,g;for(f=0;f<d;f++)g=a[f].split("="),(e=z[g.shift()])&&(c=e(c,g));for(f=0;f<b;f++)c=x[f](c);return c}function g(a,e,f,g,h){var i=b(a),j=i.autoCallback;i.url.split(".").pop().split("?").shift(),i.bypass||(e&&(e=d(e)?e:e[a]||e[g]||e[a.split("/").pop().split("?")[0]]),i.instead?i.instead(a,e,f,g,h):(y[i.url]?i.noexec=!0:y[i.url]=1,f.load(i.url,i.forceCSS||!i.forceJS&&"css"==i.url.split(".").pop().split("?").shift()?"c":c,i.noexec,i.attrs,i.timeout),(d(e)||d(j))&&f.load(function(){k(),e&&e(i.origUrl,h,g),j&&j(i.origUrl,h,g),y[i.url]=2})))}function h(a,b){function c(a,c){if(a){if(e(a))c||(j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}),g(a,j,b,0,h);else if(Object(a)===a)for(n in m=function(){var b=0,c;for(c in a)a.hasOwnProperty(c)&&b++;return b}(),a)a.hasOwnProperty(n)&&(!c&&!--m&&(d(j)?j=function(){var a=[].slice.call(arguments);k.apply(this,a),l()}:j[n]=function(a){return function(){var b=[].slice.call(arguments);a&&a.apply(this,b),l()}}(k[n])),g(a[n],j,b,n,h))}else!c&&l()}var h=!!a.test,i=a.load||a.both,j=a.callback||f,k=j,l=a.complete||f,m,n;c(h?a.yep:a.nope,!!i),i&&c(i)}var i,j,l=this.yepnope.loader;if(e(a))g(a,0,l,0);else if(w(a))for(i=0;i<a.length;i++)j=a[i],e(j)?g(j,0,l,0):w(j)?B(j):Object(j)===j&&h(j,l);else Object(a)===a&&h(a,l)},B.addPrefix=function(a,b){z[a]=b},B.addFilter=function(a){x.push(a)},B.errorTimeout=1e4,null==b.readyState&&b.addEventListener&&(b.readyState="loading",b.addEventListener("DOMContentLoaded",A=function(){b.removeEventListener("DOMContentLoaded",A,0),b.readyState="complete"},0)),a.yepnope=k(),a.yepnope.executeStack=h,a.yepnope.injectJs=function(a,c,d,e,i,j){var k=b.createElement("script"),l,o,e=e||B.errorTimeout;k.src=a;for(o in d)k.setAttribute(o,d[o]);c=j?h:c||f,k.onreadystatechange=k.onload=function(){!l&&g(k.readyState)&&(l=1,c(),k.onload=k.onreadystatechange=null)},m(function(){l||(l=1,c(1))},e),i?k.onload():n.parentNode.insertBefore(k,n)},a.yepnope.injectCss=function(a,c,d,e,g,i){var e=b.createElement("link"),j,c=i?h:c||f;e.href=a,e.rel="stylesheet",e.type="text/css";for(j in d)e.setAttribute(j,d[j]);g||(n.parentNode.insertBefore(e,n),m(c,0))}}(this,document),Modernizr.load=function(){yepnope.apply(window,[].slice.call(arguments,0))};
function toggle_visibility(id) {
  var e = document.getElementById(id);
  if(id == 'phone-menu') {
    var f = document.getElementById('phone-search');
    if( $(e).hasClass('open') ) {
      $(e).removeClass('open').slideUp();
      $(f).removeClass('open').slideUp();
    }
    else {
      $(e).addClass('open').slideDown();
      $(f).removeClass('open').slideUp();
    }
  } else {
    var f = document.getElementById('phone-menu');
    if( $(e).hasClass('open') ) {
      $(e).removeClass('open').slideUp();
    } else {
      $(e).addClass('open').slideDown();
      $(f).removeClass('open').slideUp();
    }
  }
}
!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):e.moment=t()}(this,function(){"use strict";function e(){return Yt.apply(null,arguments)}function t(e){return e instanceof Array||"[object Array]"===Object.prototype.toString.call(e)}function n(e){return null!=e&&"[object Object]"===Object.prototype.toString.call(e)}function s(e){if(Object.getOwnPropertyNames)return 0===Object.getOwnPropertyNames(e).length;var t;for(t in e)if(e.hasOwnProperty(t))return!1;return!0}function i(e){return void 0===e}function r(e){return"number"==typeof e||"[object Number]"===Object.prototype.toString.call(e)}function a(e){return e instanceof Date||"[object Date]"===Object.prototype.toString.call(e)}function o(e,t){var n,s=[];for(n=0;n<e.length;++n)s.push(t(e[n],n));return s}function u(e,t){return Object.prototype.hasOwnProperty.call(e,t)}function l(e,t){for(var n in t)u(t,n)&&(e[n]=t[n]);return u(t,"toString")&&(e.toString=t.toString),u(t,"valueOf")&&(e.valueOf=t.valueOf),e}function d(e,t,n,s){return je(e,t,n,s,!0).utc()}function h(){return{empty:!1,unusedTokens:[],unusedInput:[],overflow:-2,charsLeftOver:0,nullInput:!1,invalidMonth:null,invalidFormat:!1,userInvalidated:!1,iso:!1,parsedDateParts:[],meridiem:null,rfc2822:!1,weekdayMismatch:!1}}function c(e){return null==e._pf&&(e._pf=h()),e._pf}function f(e){if(null==e._isValid){var t=c(e),n=Ot.call(t.parsedDateParts,function(e){return null!=e}),s=!isNaN(e._d.getTime())&&t.overflow<0&&!t.empty&&!t.invalidMonth&&!t.invalidWeekday&&!t.weekdayMismatch&&!t.nullInput&&!t.invalidFormat&&!t.userInvalidated&&(!t.meridiem||t.meridiem&&n);if(e._strict&&(s=s&&0===t.charsLeftOver&&0===t.unusedTokens.length&&void 0===t.bigHour),null!=Object.isFrozen&&Object.isFrozen(e))return s;e._isValid=s}return e._isValid}function m(e){var t=d(NaN);return null!=e?l(c(t),e):c(t).userInvalidated=!0,t}function _(e,t){var n,s,r;if(i(t._isAMomentObject)||(e._isAMomentObject=t._isAMomentObject),i(t._i)||(e._i=t._i),i(t._f)||(e._f=t._f),i(t._l)||(e._l=t._l),i(t._strict)||(e._strict=t._strict),i(t._tzm)||(e._tzm=t._tzm),i(t._isUTC)||(e._isUTC=t._isUTC),i(t._offset)||(e._offset=t._offset),i(t._pf)||(e._pf=c(t)),i(t._locale)||(e._locale=t._locale),xt.length>0)for(n=0;n<xt.length;n++)i(r=t[s=xt[n]])||(e[s]=r);return e}function y(t){_(this,t),this._d=new Date(null!=t._d?t._d.getTime():NaN),this.isValid()||(this._d=new Date(NaN)),!1===Tt&&(Tt=!0,e.updateOffset(this),Tt=!1)}function g(e){return e instanceof y||null!=e&&null!=e._isAMomentObject}function p(e){return e<0?Math.ceil(e)||0:Math.floor(e)}function w(e){var t=+e,n=0;return 0!==t&&isFinite(t)&&(n=p(t)),n}function v(e,t,n){var s,i=Math.min(e.length,t.length),r=Math.abs(e.length-t.length),a=0;for(s=0;s<i;s++)(n&&e[s]!==t[s]||!n&&w(e[s])!==w(t[s]))&&a++;return a+r}function M(t){!1===e.suppressDeprecationWarnings&&"undefined"!=typeof console&&console.warn&&console.warn("Deprecation warning: "+t)}function k(t,n){var s=!0;return l(function(){if(null!=e.deprecationHandler&&e.deprecationHandler(null,t),s){for(var i,r=[],a=0;a<arguments.length;a++){if(i="","object"==typeof arguments[a]){i+="\n["+a+"] ";for(var o in arguments[0])i+=o+": "+arguments[0][o]+", ";i=i.slice(0,-2)}else i=arguments[a];r.push(i)}M(t+"\nArguments: "+Array.prototype.slice.call(r).join("")+"\n"+(new Error).stack),s=!1}return n.apply(this,arguments)},n)}function S(t,n){null!=e.deprecationHandler&&e.deprecationHandler(t,n),bt[t]||(M(n),bt[t]=!0)}function D(e){return e instanceof Function||"[object Function]"===Object.prototype.toString.call(e)}function Y(e,t){var s,i=l({},e);for(s in t)u(t,s)&&(n(e[s])&&n(t[s])?(i[s]={},l(i[s],e[s]),l(i[s],t[s])):null!=t[s]?i[s]=t[s]:delete i[s]);for(s in e)u(e,s)&&!u(t,s)&&n(e[s])&&(i[s]=l({},i[s]));return i}function O(e){null!=e&&this.set(e)}function x(e,t){var n=e.toLowerCase();Ut[n]=Ut[n+"s"]=Ut[t]=e}function T(e){return"string"==typeof e?Ut[e]||Ut[e.toLowerCase()]:void 0}function b(e){var t,n,s={};for(n in e)u(e,n)&&(t=T(n))&&(s[t]=e[n]);return s}function P(e,t){Nt[e]=t}function W(e){var t=[];for(var n in e)t.push({unit:n,priority:Nt[n]});return t.sort(function(e,t){return e.priority-t.priority}),t}function R(e,t,n){var s=""+Math.abs(e),i=t-s.length;return(e>=0?n?"+":"":"-")+Math.pow(10,Math.max(0,i)).toString().substr(1)+s}function C(e,t,n,s){var i=s;"string"==typeof s&&(i=function(){return this[s]()}),e&&(Vt[e]=i),t&&(Vt[t[0]]=function(){return R(i.apply(this,arguments),t[1],t[2])}),n&&(Vt[n]=function(){return this.localeData().ordinal(i.apply(this,arguments),e)})}function F(e){return e.match(/\[[\s\S]/)?e.replace(/^\[|\]$/g,""):e.replace(/\\/g,"")}function U(e){var t,n,s=e.match(Ht);for(t=0,n=s.length;t<n;t++)Vt[s[t]]?s[t]=Vt[s[t]]:s[t]=F(s[t]);return function(t){var i,r="";for(i=0;i<n;i++)r+=D(s[i])?s[i].call(t,e):s[i];return r}}function N(e,t){return e.isValid()?(t=H(t,e.localeData()),Gt[t]=Gt[t]||U(t),Gt[t](e)):e.localeData().invalidDate()}function H(e,t){var n=5;for(Lt.lastIndex=0;n>=0&&Lt.test(e);)e=e.replace(Lt,function(e){return t.longDateFormat(e)||e}),Lt.lastIndex=0,n-=1;return e}function L(e,t,n){rn[e]=D(t)?t:function(e,s){return e&&n?n:t}}function G(e,t){return u(rn,e)?rn[e](t._strict,t._locale):new RegExp(V(e))}function V(e){return j(e.replace("\\","").replace(/\\(\[)|\\(\])|\[([^\]\[]*)\]|\\(.)/g,function(e,t,n,s,i){return t||n||s||i}))}function j(e){return e.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}function I(e,t){var n,s=t;for("string"==typeof e&&(e=[e]),r(t)&&(s=function(e,n){n[t]=w(e)}),n=0;n<e.length;n++)an[e[n]]=s}function E(e,t){I(e,function(e,n,s,i){s._w=s._w||{},t(e,s._w,s,i)})}function A(e,t,n){null!=t&&u(an,e)&&an[e](t,n._a,n,e)}function z(e){return Z(e)?366:365}function Z(e){return e%4==0&&e%100!=0||e%400==0}function $(t,n){return function(s){return null!=s?(J(this,t,s),e.updateOffset(this,n),this):q(this,t)}}function q(e,t){return e.isValid()?e._d["get"+(e._isUTC?"UTC":"")+t]():NaN}function J(e,t,n){e.isValid()&&!isNaN(n)&&("FullYear"===t&&Z(e.year())?e._d["set"+(e._isUTC?"UTC":"")+t](n,e.month(),Q(n,e.month())):e._d["set"+(e._isUTC?"UTC":"")+t](n))}function B(e,t){return(e%t+t)%t}function Q(e,t){if(isNaN(e)||isNaN(t))return NaN;var n=B(t,12);return e+=(t-n)/12,1===n?Z(e)?29:28:31-n%7%2}function X(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._monthsParse)for(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[],s=0;s<12;++s)r=d([2e3,s]),this._shortMonthsParse[s]=this.monthsShort(r,"").toLocaleLowerCase(),this._longMonthsParse[s]=this.months(r,"").toLocaleLowerCase();return n?"MMM"===t?-1!==(i=yn.call(this._shortMonthsParse,a))?i:null:-1!==(i=yn.call(this._longMonthsParse,a))?i:null:"MMM"===t?-1!==(i=yn.call(this._shortMonthsParse,a))?i:-1!==(i=yn.call(this._longMonthsParse,a))?i:null:-1!==(i=yn.call(this._longMonthsParse,a))?i:-1!==(i=yn.call(this._shortMonthsParse,a))?i:null}function K(e,t){var n;if(!e.isValid())return e;if("string"==typeof t)if(/^\d+$/.test(t))t=w(t);else if(t=e.localeData().monthsParse(t),!r(t))return e;return n=Math.min(e.date(),Q(e.year(),t)),e._d["set"+(e._isUTC?"UTC":"")+"Month"](t,n),e}function ee(t){return null!=t?(K(this,t),e.updateOffset(this,!0),this):q(this,"Month")}function te(){function e(e,t){return t.length-e.length}var t,n,s=[],i=[],r=[];for(t=0;t<12;t++)n=d([2e3,t]),s.push(this.monthsShort(n,"")),i.push(this.months(n,"")),r.push(this.months(n,"")),r.push(this.monthsShort(n,""));for(s.sort(e),i.sort(e),r.sort(e),t=0;t<12;t++)s[t]=j(s[t]),i[t]=j(i[t]);for(t=0;t<24;t++)r[t]=j(r[t]);this._monthsRegex=new RegExp("^("+r.join("|")+")","i"),this._monthsShortRegex=this._monthsRegex,this._monthsStrictRegex=new RegExp("^("+i.join("|")+")","i"),this._monthsShortStrictRegex=new RegExp("^("+s.join("|")+")","i")}function ne(e,t,n,s,i,r,a){var o=new Date(e,t,n,s,i,r,a);return e<100&&e>=0&&isFinite(o.getFullYear())&&o.setFullYear(e),o}function se(e){var t=new Date(Date.UTC.apply(null,arguments));return e<100&&e>=0&&isFinite(t.getUTCFullYear())&&t.setUTCFullYear(e),t}function ie(e,t,n){var s=7+t-n;return-((7+se(e,0,s).getUTCDay()-t)%7)+s-1}function re(e,t,n,s,i){var r,a,o=1+7*(t-1)+(7+n-s)%7+ie(e,s,i);return o<=0?a=z(r=e-1)+o:o>z(e)?(r=e+1,a=o-z(e)):(r=e,a=o),{year:r,dayOfYear:a}}function ae(e,t,n){var s,i,r=ie(e.year(),t,n),a=Math.floor((e.dayOfYear()-r-1)/7)+1;return a<1?s=a+oe(i=e.year()-1,t,n):a>oe(e.year(),t,n)?(s=a-oe(e.year(),t,n),i=e.year()+1):(i=e.year(),s=a),{week:s,year:i}}function oe(e,t,n){var s=ie(e,t,n),i=ie(e+1,t,n);return(z(e)-s+i)/7}function ue(e,t){return"string"!=typeof e?e:isNaN(e)?"number"==typeof(e=t.weekdaysParse(e))?e:null:parseInt(e,10)}function le(e,t){return"string"==typeof e?t.weekdaysParse(e)%7||7:isNaN(e)?null:e}function de(e,t,n){var s,i,r,a=e.toLocaleLowerCase();if(!this._weekdaysParse)for(this._weekdaysParse=[],this._shortWeekdaysParse=[],this._minWeekdaysParse=[],s=0;s<7;++s)r=d([2e3,1]).day(s),this._minWeekdaysParse[s]=this.weekdaysMin(r,"").toLocaleLowerCase(),this._shortWeekdaysParse[s]=this.weekdaysShort(r,"").toLocaleLowerCase(),this._weekdaysParse[s]=this.weekdays(r,"").toLocaleLowerCase();return n?"dddd"===t?-1!==(i=yn.call(this._weekdaysParse,a))?i:null:"ddd"===t?-1!==(i=yn.call(this._shortWeekdaysParse,a))?i:null:-1!==(i=yn.call(this._minWeekdaysParse,a))?i:null:"dddd"===t?-1!==(i=yn.call(this._weekdaysParse,a))?i:-1!==(i=yn.call(this._shortWeekdaysParse,a))?i:-1!==(i=yn.call(this._minWeekdaysParse,a))?i:null:"ddd"===t?-1!==(i=yn.call(this._shortWeekdaysParse,a))?i:-1!==(i=yn.call(this._weekdaysParse,a))?i:-1!==(i=yn.call(this._minWeekdaysParse,a))?i:null:-1!==(i=yn.call(this._minWeekdaysParse,a))?i:-1!==(i=yn.call(this._weekdaysParse,a))?i:-1!==(i=yn.call(this._shortWeekdaysParse,a))?i:null}function he(){function e(e,t){return t.length-e.length}var t,n,s,i,r,a=[],o=[],u=[],l=[];for(t=0;t<7;t++)n=d([2e3,1]).day(t),s=this.weekdaysMin(n,""),i=this.weekdaysShort(n,""),r=this.weekdays(n,""),a.push(s),o.push(i),u.push(r),l.push(s),l.push(i),l.push(r);for(a.sort(e),o.sort(e),u.sort(e),l.sort(e),t=0;t<7;t++)o[t]=j(o[t]),u[t]=j(u[t]),l[t]=j(l[t]);this._weekdaysRegex=new RegExp("^("+l.join("|")+")","i"),this._weekdaysShortRegex=this._weekdaysRegex,this._weekdaysMinRegex=this._weekdaysRegex,this._weekdaysStrictRegex=new RegExp("^("+u.join("|")+")","i"),this._weekdaysShortStrictRegex=new RegExp("^("+o.join("|")+")","i"),this._weekdaysMinStrictRegex=new RegExp("^("+a.join("|")+")","i")}function ce(){return this.hours()%12||12}function fe(e,t){C(e,0,0,function(){return this.localeData().meridiem(this.hours(),this.minutes(),t)})}function me(e,t){return t._meridiemParse}function _e(e){return e?e.toLowerCase().replace("_","-"):e}function ye(e){for(var t,n,s,i,r=0;r<e.length;){for(t=(i=_e(e[r]).split("-")).length,n=(n=_e(e[r+1]))?n.split("-"):null;t>0;){if(s=ge(i.slice(0,t).join("-")))return s;if(n&&n.length>=t&&v(i,n,!0)>=t-1)break;t--}r++}return null}function ge(e){var t=null;if(!Fn[e]&&"undefined"!=typeof module&&module&&module.exports){t=Pn._abbr;try{require("moment/locale/"+e)}catch(t){try{require("./locale/"+e)}catch(e){}}pe(t)}return Fn[e]}function pe(e,t){var n;return e&&(n=i(t)?ve(e):we(e,t))&&(Pn=n),Pn._abbr}function we(e,t){if(null!==t){var n=Cn;if(t.abbr=e,null!=Fn[e])S("defineLocaleOverride","use moment.updateLocale(localeName, config) to change an existing locale. moment.defineLocale(localeName, config) should only be used for creating a new locale See http://momentjs.com/guides/#/warnings/define-locale/ for more info."),n=Fn[e]._config;else if(null!=t.parentLocale){if(null==Fn[t.parentLocale])return Un[t.parentLocale]||(Un[t.parentLocale]=[]),Un[t.parentLocale].push({name:e,config:t}),null;n=Fn[t.parentLocale]._config}return Fn[e]=new O(Y(n,t)),Un[e]&&Un[e].forEach(function(e){we(e.name,e.config)}),pe(e),Fn[e]}return delete Fn[e],null}function ve(e){var n;if(e&&e._locale&&e._locale._abbr&&(e=e._locale._abbr),!e)return Pn;if(!t(e)){if(n=ge(e))return n;e=[e]}return ye(e)}function Me(e){var t,n=e._a;return n&&-2===c(e).overflow&&(t=n[un]<0||n[un]>11?un:n[ln]<1||n[ln]>Q(n[on],n[un])?ln:n[dn]<0||n[dn]>24||24===n[dn]&&(0!==n[hn]||0!==n[cn]||0!==n[fn])?dn:n[hn]<0||n[hn]>59?hn:n[cn]<0||n[cn]>59?cn:n[fn]<0||n[fn]>999?fn:-1,c(e)._overflowDayOfYear&&(t<on||t>ln)&&(t=ln),c(e)._overflowWeeks&&-1===t&&(t=mn),c(e)._overflowWeekday&&-1===t&&(t=_n),c(e).overflow=t),e}function ke(e,t,n){return null!=e?e:null!=t?t:n}function Se(t){var n=new Date(e.now());return t._useUTC?[n.getUTCFullYear(),n.getUTCMonth(),n.getUTCDate()]:[n.getFullYear(),n.getMonth(),n.getDate()]}function De(e){var t,n,s,i,r=[];if(!e._d){for(s=Se(e),e._w&&null==e._a[ln]&&null==e._a[un]&&Ye(e),null!=e._dayOfYear&&(i=ke(e._a[on],s[on]),(e._dayOfYear>z(i)||0===e._dayOfYear)&&(c(e)._overflowDayOfYear=!0),n=se(i,0,e._dayOfYear),e._a[un]=n.getUTCMonth(),e._a[ln]=n.getUTCDate()),t=0;t<3&&null==e._a[t];++t)e._a[t]=r[t]=s[t];for(;t<7;t++)e._a[t]=r[t]=null==e._a[t]?2===t?1:0:e._a[t];24===e._a[dn]&&0===e._a[hn]&&0===e._a[cn]&&0===e._a[fn]&&(e._nextDay=!0,e._a[dn]=0),e._d=(e._useUTC?se:ne).apply(null,r),null!=e._tzm&&e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),e._nextDay&&(e._a[dn]=24),e._w&&void 0!==e._w.d&&e._w.d!==e._d.getDay()&&(c(e).weekdayMismatch=!0)}}function Ye(e){var t,n,s,i,r,a,o,u;if(null!=(t=e._w).GG||null!=t.W||null!=t.E)r=1,a=4,n=ke(t.GG,e._a[on],ae(Ie(),1,4).year),s=ke(t.W,1),((i=ke(t.E,1))<1||i>7)&&(u=!0);else{r=e._locale._week.dow,a=e._locale._week.doy;var l=ae(Ie(),r,a);n=ke(t.gg,e._a[on],l.year),s=ke(t.w,l.week),null!=t.d?((i=t.d)<0||i>6)&&(u=!0):null!=t.e?(i=t.e+r,(t.e<0||t.e>6)&&(u=!0)):i=r}s<1||s>oe(n,r,a)?c(e)._overflowWeeks=!0:null!=u?c(e)._overflowWeekday=!0:(o=re(n,s,i,r,a),e._a[on]=o.year,e._dayOfYear=o.dayOfYear)}function Oe(e){var t,n,s,i,r,a,o=e._i,u=Nn.exec(o)||Hn.exec(o);if(u){for(c(e).iso=!0,t=0,n=Gn.length;t<n;t++)if(Gn[t][1].exec(u[1])){i=Gn[t][0],s=!1!==Gn[t][2];break}if(null==i)return void(e._isValid=!1);if(u[3]){for(t=0,n=Vn.length;t<n;t++)if(Vn[t][1].exec(u[3])){r=(u[2]||" ")+Vn[t][0];break}if(null==r)return void(e._isValid=!1)}if(!s&&null!=r)return void(e._isValid=!1);if(u[4]){if(!Ln.exec(u[4]))return void(e._isValid=!1);a="Z"}e._f=i+(r||"")+(a||""),Fe(e)}else e._isValid=!1}function xe(e,t,n,s,i,r){var a=[Te(e),vn.indexOf(t),parseInt(n,10),parseInt(s,10),parseInt(i,10)];return r&&a.push(parseInt(r,10)),a}function Te(e){var t=parseInt(e,10);return t<=49?2e3+t:t<=999?1900+t:t}function be(e){return e.replace(/\([^)]*\)|[\n\t]/g," ").replace(/(\s\s+)/g," ").trim()}function Pe(e,t,n){return!e||Yn.indexOf(e)===new Date(t[0],t[1],t[2]).getDay()||(c(n).weekdayMismatch=!0,n._isValid=!1,!1)}function We(e,t,n){if(e)return En[e];if(t)return 0;var s=parseInt(n,10),i=s%100;return 60*((s-i)/100)+i}function Re(e){var t=In.exec(be(e._i));if(t){var n=xe(t[4],t[3],t[2],t[5],t[6],t[7]);if(!Pe(t[1],n,e))return;e._a=n,e._tzm=We(t[8],t[9],t[10]),e._d=se.apply(null,e._a),e._d.setUTCMinutes(e._d.getUTCMinutes()-e._tzm),c(e).rfc2822=!0}else e._isValid=!1}function Ce(t){var n=jn.exec(t._i);null===n?(Oe(t),!1===t._isValid&&(delete t._isValid,Re(t),!1===t._isValid&&(delete t._isValid,e.createFromInputFallback(t)))):t._d=new Date(+n[1])}function Fe(t){if(t._f!==e.ISO_8601)if(t._f!==e.RFC_2822){t._a=[],c(t).empty=!0;var n,s,i,r,a,o=""+t._i,u=o.length,l=0;for(i=H(t._f,t._locale).match(Ht)||[],n=0;n<i.length;n++)r=i[n],(s=(o.match(G(r,t))||[])[0])&&((a=o.substr(0,o.indexOf(s))).length>0&&c(t).unusedInput.push(a),o=o.slice(o.indexOf(s)+s.length),l+=s.length),Vt[r]?(s?c(t).empty=!1:c(t).unusedTokens.push(r),A(r,s,t)):t._strict&&!s&&c(t).unusedTokens.push(r);c(t).charsLeftOver=u-l,o.length>0&&c(t).unusedInput.push(o),t._a[dn]<=12&&!0===c(t).bigHour&&t._a[dn]>0&&(c(t).bigHour=void 0),c(t).parsedDateParts=t._a.slice(0),c(t).meridiem=t._meridiem,t._a[dn]=Ue(t._locale,t._a[dn],t._meridiem),De(t),Me(t)}else Re(t);else Oe(t)}function Ue(e,t,n){var s;return null==n?t:null!=e.meridiemHour?e.meridiemHour(t,n):null!=e.isPM?((s=e.isPM(n))&&t<12&&(t+=12),s||12!==t||(t=0),t):t}function Ne(e){var t,n,s,i,r;if(0===e._f.length)return c(e).invalidFormat=!0,void(e._d=new Date(NaN));for(i=0;i<e._f.length;i++)r=0,t=_({},e),null!=e._useUTC&&(t._useUTC=e._useUTC),t._f=e._f[i],Fe(t),f(t)&&(r+=c(t).charsLeftOver,r+=10*c(t).unusedTokens.length,c(t).score=r,(null==s||r<s)&&(s=r,n=t));l(e,n||t)}function He(e){if(!e._d){var t=b(e._i);e._a=o([t.year,t.month,t.day||t.date,t.hour,t.minute,t.second,t.millisecond],function(e){return e&&parseInt(e,10)}),De(e)}}function Le(e){var t=new y(Me(Ge(e)));return t._nextDay&&(t.add(1,"d"),t._nextDay=void 0),t}function Ge(e){var n=e._i,s=e._f;return e._locale=e._locale||ve(e._l),null===n||void 0===s&&""===n?m({nullInput:!0}):("string"==typeof n&&(e._i=n=e._locale.preparse(n)),g(n)?new y(Me(n)):(a(n)?e._d=n:t(s)?Ne(e):s?Fe(e):Ve(e),f(e)||(e._d=null),e))}function Ve(s){var u=s._i;i(u)?s._d=new Date(e.now()):a(u)?s._d=new Date(u.valueOf()):"string"==typeof u?Ce(s):t(u)?(s._a=o(u.slice(0),function(e){return parseInt(e,10)}),De(s)):n(u)?He(s):r(u)?s._d=new Date(u):e.createFromInputFallback(s)}function je(e,i,r,a,o){var u={};return!0!==r&&!1!==r||(a=r,r=void 0),(n(e)&&s(e)||t(e)&&0===e.length)&&(e=void 0),u._isAMomentObject=!0,u._useUTC=u._isUTC=o,u._l=r,u._i=e,u._f=i,u._strict=a,Le(u)}function Ie(e,t,n,s){return je(e,t,n,s,!1)}function Ee(e,n){var s,i;if(1===n.length&&t(n[0])&&(n=n[0]),!n.length)return Ie();for(s=n[0],i=1;i<n.length;++i)n[i].isValid()&&!n[i][e](s)||(s=n[i]);return s}function Ae(e){for(var t in e)if(-1===yn.call(Zn,t)||null!=e[t]&&isNaN(e[t]))return!1;for(var n=!1,s=0;s<Zn.length;++s)if(e[Zn[s]]){if(n)return!1;parseFloat(e[Zn[s]])!==w(e[Zn[s]])&&(n=!0)}return!0}function ze(e){var t=b(e),n=t.year||0,s=t.quarter||0,i=t.month||0,r=t.week||0,a=t.day||0,o=t.hour||0,u=t.minute||0,l=t.second||0,d=t.millisecond||0;this._isValid=Ae(t),this._milliseconds=+d+1e3*l+6e4*u+1e3*o*60*60,this._days=+a+7*r,this._months=+i+3*s+12*n,this._data={},this._locale=ve(),this._bubble()}function Ze(e){return e instanceof ze}function $e(e){return e<0?-1*Math.round(-1*e):Math.round(e)}function qe(e,t){C(e,0,0,function(){var e=this.utcOffset(),n="+";return e<0&&(e=-e,n="-"),n+R(~~(e/60),2)+t+R(~~e%60,2)})}function Je(e,t){var n=(t||"").match(e);if(null===n)return null;var s=((n[n.length-1]||[])+"").match($n)||["-",0,0],i=60*s[1]+w(s[2]);return 0===i?0:"+"===s[0]?i:-i}function Be(t,n){var s,i;return n._isUTC?(s=n.clone(),i=(g(t)||a(t)?t.valueOf():Ie(t).valueOf())-s.valueOf(),s._d.setTime(s._d.valueOf()+i),e.updateOffset(s,!1),s):Ie(t).local()}function Qe(e){return 15*-Math.round(e._d.getTimezoneOffset()/15)}function Xe(){return!!this.isValid()&&(this._isUTC&&0===this._offset)}function Ke(e,t){var n,s,i,a=e,o=null;return Ze(e)?a={ms:e._milliseconds,d:e._days,M:e._months}:r(e)?(a={},t?a[t]=e:a.milliseconds=e):(o=qn.exec(e))?(n="-"===o[1]?-1:1,a={y:0,d:w(o[ln])*n,h:w(o[dn])*n,m:w(o[hn])*n,s:w(o[cn])*n,ms:w($e(1e3*o[fn]))*n}):(o=Jn.exec(e))?(n="-"===o[1]?-1:(o[1],1),a={y:et(o[2],n),M:et(o[3],n),w:et(o[4],n),d:et(o[5],n),h:et(o[6],n),m:et(o[7],n),s:et(o[8],n)}):null==a?a={}:"object"==typeof a&&("from"in a||"to"in a)&&(i=nt(Ie(a.from),Ie(a.to)),(a={}).ms=i.milliseconds,a.M=i.months),s=new ze(a),Ze(e)&&u(e,"_locale")&&(s._locale=e._locale),s}function et(e,t){var n=e&&parseFloat(e.replace(",","."));return(isNaN(n)?0:n)*t}function tt(e,t){var n={milliseconds:0,months:0};return n.months=t.month()-e.month()+12*(t.year()-e.year()),e.clone().add(n.months,"M").isAfter(t)&&--n.months,n.milliseconds=+t-+e.clone().add(n.months,"M"),n}function nt(e,t){var n;return e.isValid()&&t.isValid()?(t=Be(t,e),e.isBefore(t)?n=tt(e,t):((n=tt(t,e)).milliseconds=-n.milliseconds,n.months=-n.months),n):{milliseconds:0,months:0}}function st(e,t){return function(n,s){var i,r;return null===s||isNaN(+s)||(S(t,"moment()."+t+"(period, number) is deprecated. Please use moment()."+t+"(number, period). See http://momentjs.com/guides/#/warnings/add-inverted-param/ for more info."),r=n,n=s,s=r),n="string"==typeof n?+n:n,i=Ke(n,s),it(this,i,e),this}}function it(t,n,s,i){var r=n._milliseconds,a=$e(n._days),o=$e(n._months);t.isValid()&&(i=null==i||i,o&&K(t,q(t,"Month")+o*s),a&&J(t,"Date",q(t,"Date")+a*s),r&&t._d.setTime(t._d.valueOf()+r*s),i&&e.updateOffset(t,a||o))}function rt(e,t){var n,s=12*(t.year()-e.year())+(t.month()-e.month()),i=e.clone().add(s,"months");return n=t-i<0?(t-i)/(i-e.clone().add(s-1,"months")):(t-i)/(e.clone().add(s+1,"months")-i),-(s+n)||0}function at(e){var t;return void 0===e?this._locale._abbr:(null!=(t=ve(e))&&(this._locale=t),this)}function ot(){return this._locale}function ut(e,t){C(0,[e,e.length],0,t)}function lt(e,t,n,s,i){var r;return null==e?ae(this,s,i).year:(r=oe(e,s,i),t>r&&(t=r),dt.call(this,e,t,n,s,i))}function dt(e,t,n,s,i){var r=re(e,t,n,s,i),a=se(r.year,0,r.dayOfYear);return this.year(a.getUTCFullYear()),this.month(a.getUTCMonth()),this.date(a.getUTCDate()),this}function ht(e){return e}function ct(e,t,n,s){var i=ve(),r=d().set(s,t);return i[n](r,e)}function ft(e,t,n){if(r(e)&&(t=e,e=void 0),e=e||"",null!=t)return ct(e,t,n,"month");var s,i=[];for(s=0;s<12;s++)i[s]=ct(e,s,n,"month");return i}function mt(e,t,n,s){"boolean"==typeof e?(r(t)&&(n=t,t=void 0),t=t||""):(n=t=e,e=!1,r(t)&&(n=t,t=void 0),t=t||"");var i=ve(),a=e?i._week.dow:0;if(null!=n)return ct(t,(n+a)%7,s,"day");var o,u=[];for(o=0;o<7;o++)u[o]=ct(t,(o+a)%7,s,"day");return u}function _t(e,t,n,s){var i=Ke(t,n);return e._milliseconds+=s*i._milliseconds,e._days+=s*i._days,e._months+=s*i._months,e._bubble()}function yt(e){return e<0?Math.floor(e):Math.ceil(e)}function gt(e){return 4800*e/146097}function pt(e){return 146097*e/4800}function wt(e){return function(){return this.as(e)}}function vt(e){return function(){return this.isValid()?this._data[e]:NaN}}function Mt(e,t,n,s,i){return i.relativeTime(t||1,!!n,e,s)}function kt(e,t,n){var s=Ke(e).abs(),i=ks(s.as("s")),r=ks(s.as("m")),a=ks(s.as("h")),o=ks(s.as("d")),u=ks(s.as("M")),l=ks(s.as("y")),d=i<=Ss.ss&&["s",i]||i<Ss.s&&["ss",i]||r<=1&&["m"]||r<Ss.m&&["mm",r]||a<=1&&["h"]||a<Ss.h&&["hh",a]||o<=1&&["d"]||o<Ss.d&&["dd",o]||u<=1&&["M"]||u<Ss.M&&["MM",u]||l<=1&&["y"]||["yy",l];return d[2]=t,d[3]=+e>0,d[4]=n,Mt.apply(null,d)}function St(e){return(e>0)-(e<0)||+e}function Dt(){if(!this.isValid())return this.localeData().invalidDate();var e,t,n,s=Ds(this._milliseconds)/1e3,i=Ds(this._days),r=Ds(this._months);t=p((e=p(s/60))/60),s%=60,e%=60;var a=n=p(r/12),o=r%=12,u=i,l=t,d=e,h=s?s.toFixed(3).replace(/\.?0+$/,""):"",c=this.asSeconds();if(!c)return"P0D";var f=c<0?"-":"",m=St(this._months)!==St(c)?"-":"",_=St(this._days)!==St(c)?"-":"",y=St(this._milliseconds)!==St(c)?"-":"";return f+"P"+(a?m+a+"Y":"")+(o?m+o+"M":"")+(u?_+u+"D":"")+(l||d||h?"T":"")+(l?y+l+"H":"")+(d?y+d+"M":"")+(h?y+h+"S":"")}var Yt,Ot;Ot=Array.prototype.some?Array.prototype.some:function(e){for(var t=Object(this),n=t.length>>>0,s=0;s<n;s++)if(s in t&&e.call(this,t[s],s,t))return!0;return!1};var xt=e.momentProperties=[],Tt=!1,bt={};e.suppressDeprecationWarnings=!1,e.deprecationHandler=null;var Pt;Pt=Object.keys?Object.keys:function(e){var t,n=[];for(t in e)u(e,t)&&n.push(t);return n};var Wt={sameDay:"[Today at] LT",nextDay:"[Tomorrow at] LT",nextWeek:"dddd [at] LT",lastDay:"[Yesterday at] LT",lastWeek:"[Last] dddd [at] LT",sameElse:"L"},Rt={LTS:"h:mm:ss A",LT:"h:mm A",L:"MM/DD/YYYY",LL:"MMMM D, YYYY",LLL:"MMMM D, YYYY h:mm A",LLLL:"dddd, MMMM D, YYYY h:mm A"},Ct=/\d{1,2}/,Ft={future:"in %s",past:"%s ago",s:"a few seconds",ss:"%d seconds",m:"a minute",mm:"%d minutes",h:"an hour",hh:"%d hours",d:"a day",dd:"%d days",M:"a month",MM:"%d months",y:"a year",yy:"%d years"},Ut={},Nt={},Ht=/(\[[^\[]*\])|(\\)?([Hh]mm(ss)?|Mo|MM?M?M?|Do|DDDo|DD?D?D?|ddd?d?|do?|w[o|w]?|W[o|W]?|Qo?|YYYYYY|YYYYY|YYYY|YY|gg(ggg?)?|GG(GGG?)?|e|E|a|A|hh?|HH?|kk?|mm?|ss?|S{1,9}|x|X|zz?|ZZ?|.)/g,Lt=/(\[[^\[]*\])|(\\)?(LTS|LT|LL?L?L?|l{1,4})/g,Gt={},Vt={},jt=/\d/,It=/\d\d/,Et=/\d{3}/,At=/\d{4}/,zt=/[+-]?\d{6}/,Zt=/\d\d?/,$t=/\d\d\d\d?/,qt=/\d\d\d\d\d\d?/,Jt=/\d{1,3}/,Bt=/\d{1,4}/,Qt=/[+-]?\d{1,6}/,Xt=/\d+/,Kt=/[+-]?\d+/,en=/Z|[+-]\d\d:?\d\d/gi,tn=/Z|[+-]\d\d(?::?\d\d)?/gi,nn=/[+-]?\d+(\.\d{1,3})?/,sn=/[0-9]*['a-z\u00A0-\u05FF\u0700-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]+|[\u0600-\u06FF\/]+(\s*?[\u0600-\u06FF]+){1,2}/i,rn={},an={},on=0,un=1,ln=2,dn=3,hn=4,cn=5,fn=6,mn=7,_n=8;C("Y",0,0,function(){var e=this.year();return e<=9999?""+e:"+"+e}),C(0,["YY",2],0,function(){return this.year()%100}),C(0,["YYYY",4],0,"year"),C(0,["YYYYY",5],0,"year"),C(0,["YYYYYY",6,!0],0,"year"),x("year","y"),P("year",1),L("Y",Kt),L("YY",Zt,It),L("YYYY",Bt,At),L("YYYYY",Qt,zt),L("YYYYYY",Qt,zt),I(["YYYYY","YYYYYY"],on),I("YYYY",function(t,n){n[on]=2===t.length?e.parseTwoDigitYear(t):w(t)}),I("YY",function(t,n){n[on]=e.parseTwoDigitYear(t)}),I("Y",function(e,t){t[on]=parseInt(e,10)}),e.parseTwoDigitYear=function(e){return w(e)+(w(e)>68?1900:2e3)};var yn,gn=$("FullYear",!0);yn=Array.prototype.indexOf?Array.prototype.indexOf:function(e){var t;for(t=0;t<this.length;++t)if(this[t]===e)return t;return-1},C("M",["MM",2],"Mo",function(){return this.month()+1}),C("MMM",0,0,function(e){return this.localeData().monthsShort(this,e)}),C("MMMM",0,0,function(e){return this.localeData().months(this,e)}),x("month","M"),P("month",8),L("M",Zt),L("MM",Zt,It),L("MMM",function(e,t){return t.monthsShortRegex(e)}),L("MMMM",function(e,t){return t.monthsRegex(e)}),I(["M","MM"],function(e,t){t[un]=w(e)-1}),I(["MMM","MMMM"],function(e,t,n,s){var i=n._locale.monthsParse(e,s,n._strict);null!=i?t[un]=i:c(n).invalidMonth=e});var pn=/D[oD]?(\[[^\[\]]*\]|\s)+MMMM?/,wn="January_February_March_April_May_June_July_August_September_October_November_December".split("_"),vn="Jan_Feb_Mar_Apr_May_Jun_Jul_Aug_Sep_Oct_Nov_Dec".split("_"),Mn=sn,kn=sn;C("w",["ww",2],"wo","week"),C("W",["WW",2],"Wo","isoWeek"),x("week","w"),x("isoWeek","W"),P("week",5),P("isoWeek",5),L("w",Zt),L("ww",Zt,It),L("W",Zt),L("WW",Zt,It),E(["w","ww","W","WW"],function(e,t,n,s){t[s.substr(0,1)]=w(e)});var Sn={dow:0,doy:6};C("d",0,"do","day"),C("dd",0,0,function(e){return this.localeData().weekdaysMin(this,e)}),C("ddd",0,0,function(e){return this.localeData().weekdaysShort(this,e)}),C("dddd",0,0,function(e){return this.localeData().weekdays(this,e)}),C("e",0,0,"weekday"),C("E",0,0,"isoWeekday"),x("day","d"),x("weekday","e"),x("isoWeekday","E"),P("day",11),P("weekday",11),P("isoWeekday",11),L("d",Zt),L("e",Zt),L("E",Zt),L("dd",function(e,t){return t.weekdaysMinRegex(e)}),L("ddd",function(e,t){return t.weekdaysShortRegex(e)}),L("dddd",function(e,t){return t.weekdaysRegex(e)}),E(["dd","ddd","dddd"],function(e,t,n,s){var i=n._locale.weekdaysParse(e,s,n._strict);null!=i?t.d=i:c(n).invalidWeekday=e}),E(["d","e","E"],function(e,t,n,s){t[s]=w(e)});var Dn="Sunday_Monday_Tuesday_Wednesday_Thursday_Friday_Saturday".split("_"),Yn="Sun_Mon_Tue_Wed_Thu_Fri_Sat".split("_"),On="Su_Mo_Tu_We_Th_Fr_Sa".split("_"),xn=sn,Tn=sn,bn=sn;C("H",["HH",2],0,"hour"),C("h",["hh",2],0,ce),C("k",["kk",2],0,function(){return this.hours()||24}),C("hmm",0,0,function(){return""+ce.apply(this)+R(this.minutes(),2)}),C("hmmss",0,0,function(){return""+ce.apply(this)+R(this.minutes(),2)+R(this.seconds(),2)}),C("Hmm",0,0,function(){return""+this.hours()+R(this.minutes(),2)}),C("Hmmss",0,0,function(){return""+this.hours()+R(this.minutes(),2)+R(this.seconds(),2)}),fe("a",!0),fe("A",!1),x("hour","h"),P("hour",13),L("a",me),L("A",me),L("H",Zt),L("h",Zt),L("k",Zt),L("HH",Zt,It),L("hh",Zt,It),L("kk",Zt,It),L("hmm",$t),L("hmmss",qt),L("Hmm",$t),L("Hmmss",qt),I(["H","HH"],dn),I(["k","kk"],function(e,t,n){var s=w(e);t[dn]=24===s?0:s}),I(["a","A"],function(e,t,n){n._isPm=n._locale.isPM(e),n._meridiem=e}),I(["h","hh"],function(e,t,n){t[dn]=w(e),c(n).bigHour=!0}),I("hmm",function(e,t,n){var s=e.length-2;t[dn]=w(e.substr(0,s)),t[hn]=w(e.substr(s)),c(n).bigHour=!0}),I("hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[dn]=w(e.substr(0,s)),t[hn]=w(e.substr(s,2)),t[cn]=w(e.substr(i)),c(n).bigHour=!0}),I("Hmm",function(e,t,n){var s=e.length-2;t[dn]=w(e.substr(0,s)),t[hn]=w(e.substr(s))}),I("Hmmss",function(e,t,n){var s=e.length-4,i=e.length-2;t[dn]=w(e.substr(0,s)),t[hn]=w(e.substr(s,2)),t[cn]=w(e.substr(i))});var Pn,Wn=/[ap]\.?m?\.?/i,Rn=$("Hours",!0),Cn={calendar:Wt,longDateFormat:Rt,invalidDate:"Invalid date",ordinal:"%d",dayOfMonthOrdinalParse:Ct,relativeTime:Ft,months:wn,monthsShort:vn,week:Sn,weekdays:Dn,weekdaysMin:On,weekdaysShort:Yn,meridiemParse:Wn},Fn={},Un={},Nn=/^\s*((?:[+-]\d{6}|\d{4})-(?:\d\d-\d\d|W\d\d-\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?::\d\d(?::\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Hn=/^\s*((?:[+-]\d{6}|\d{4})(?:\d\d\d\d|W\d\d\d|W\d\d|\d\d\d|\d\d))(?:(T| )(\d\d(?:\d\d(?:\d\d(?:[.,]\d+)?)?)?)([\+\-]\d\d(?::?\d\d)?|\s*Z)?)?$/,Ln=/Z|[+-]\d\d(?::?\d\d)?/,Gn=[["YYYYYY-MM-DD",/[+-]\d{6}-\d\d-\d\d/],["YYYY-MM-DD",/\d{4}-\d\d-\d\d/],["GGGG-[W]WW-E",/\d{4}-W\d\d-\d/],["GGGG-[W]WW",/\d{4}-W\d\d/,!1],["YYYY-DDD",/\d{4}-\d{3}/],["YYYY-MM",/\d{4}-\d\d/,!1],["YYYYYYMMDD",/[+-]\d{10}/],["YYYYMMDD",/\d{8}/],["GGGG[W]WWE",/\d{4}W\d{3}/],["GGGG[W]WW",/\d{4}W\d{2}/,!1],["YYYYDDD",/\d{7}/]],Vn=[["HH:mm:ss.SSSS",/\d\d:\d\d:\d\d\.\d+/],["HH:mm:ss,SSSS",/\d\d:\d\d:\d\d,\d+/],["HH:mm:ss",/\d\d:\d\d:\d\d/],["HH:mm",/\d\d:\d\d/],["HHmmss.SSSS",/\d\d\d\d\d\d\.\d+/],["HHmmss,SSSS",/\d\d\d\d\d\d,\d+/],["HHmmss",/\d\d\d\d\d\d/],["HHmm",/\d\d\d\d/],["HH",/\d\d/]],jn=/^\/?Date\((\-?\d+)/i,In=/^(?:(Mon|Tue|Wed|Thu|Fri|Sat|Sun),?\s)?(\d{1,2})\s(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)\s(\d{2,4})\s(\d\d):(\d\d)(?::(\d\d))?\s(?:(UT|GMT|[ECMP][SD]T)|([Zz])|([+-]\d{4}))$/,En={UT:0,GMT:0,EDT:-240,EST:-300,CDT:-300,CST:-360,MDT:-360,MST:-420,PDT:-420,PST:-480};e.createFromInputFallback=k("value provided is not in a recognized RFC2822 or ISO format. moment construction falls back to js Date(), which is not reliable across all browsers and versions. Non RFC2822/ISO date formats are discouraged and will be removed in an upcoming major release. Please refer to http://momentjs.com/guides/#/warnings/js-date/ for more info.",function(e){e._d=new Date(e._i+(e._useUTC?" UTC":""))}),e.ISO_8601=function(){},e.RFC_2822=function(){};var An=k("moment().min is deprecated, use moment.max instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ie.apply(null,arguments);return this.isValid()&&e.isValid()?e<this?this:e:m()}),zn=k("moment().max is deprecated, use moment.min instead. http://momentjs.com/guides/#/warnings/min-max/",function(){var e=Ie.apply(null,arguments);return this.isValid()&&e.isValid()?e>this?this:e:m()}),Zn=["year","quarter","month","week","day","hour","minute","second","millisecond"];qe("Z",":"),qe("ZZ",""),L("Z",tn),L("ZZ",tn),I(["Z","ZZ"],function(e,t,n){n._useUTC=!0,n._tzm=Je(tn,e)});var $n=/([\+\-]|\d\d)/gi;e.updateOffset=function(){};var qn=/^(\-|\+)?(?:(\d*)[. ])?(\d+)\:(\d+)(?:\:(\d+)(\.\d*)?)?$/,Jn=/^(-|\+)?P(?:([-+]?[0-9,.]*)Y)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)W)?(?:([-+]?[0-9,.]*)D)?(?:T(?:([-+]?[0-9,.]*)H)?(?:([-+]?[0-9,.]*)M)?(?:([-+]?[0-9,.]*)S)?)?$/;Ke.fn=ze.prototype,Ke.invalid=function(){return Ke(NaN)};var Bn=st(1,"add"),Qn=st(-1,"subtract");e.defaultFormat="YYYY-MM-DDTHH:mm:ssZ",e.defaultFormatUtc="YYYY-MM-DDTHH:mm:ss[Z]";var Xn=k("moment().lang() is deprecated. Instead, use moment().localeData() to get the language configuration. Use moment().locale() to change languages.",function(e){return void 0===e?this.localeData():this.locale(e)});C(0,["gg",2],0,function(){return this.weekYear()%100}),C(0,["GG",2],0,function(){return this.isoWeekYear()%100}),ut("gggg","weekYear"),ut("ggggg","weekYear"),ut("GGGG","isoWeekYear"),ut("GGGGG","isoWeekYear"),x("weekYear","gg"),x("isoWeekYear","GG"),P("weekYear",1),P("isoWeekYear",1),L("G",Kt),L("g",Kt),L("GG",Zt,It),L("gg",Zt,It),L("GGGG",Bt,At),L("gggg",Bt,At),L("GGGGG",Qt,zt),L("ggggg",Qt,zt),E(["gggg","ggggg","GGGG","GGGGG"],function(e,t,n,s){t[s.substr(0,2)]=w(e)}),E(["gg","GG"],function(t,n,s,i){n[i]=e.parseTwoDigitYear(t)}),C("Q",0,"Qo","quarter"),x("quarter","Q"),P("quarter",7),L("Q",jt),I("Q",function(e,t){t[un]=3*(w(e)-1)}),C("D",["DD",2],"Do","date"),x("date","D"),P("date",9),L("D",Zt),L("DD",Zt,It),L("Do",function(e,t){return e?t._dayOfMonthOrdinalParse||t._ordinalParse:t._dayOfMonthOrdinalParseLenient}),I(["D","DD"],ln),I("Do",function(e,t){t[ln]=w(e.match(Zt)[0],10)});var Kn=$("Date",!0);C("DDD",["DDDD",3],"DDDo","dayOfYear"),x("dayOfYear","DDD"),P("dayOfYear",4),L("DDD",Jt),L("DDDD",Et),I(["DDD","DDDD"],function(e,t,n){n._dayOfYear=w(e)}),C("m",["mm",2],0,"minute"),x("minute","m"),P("minute",14),L("m",Zt),L("mm",Zt,It),I(["m","mm"],hn);var es=$("Minutes",!1);C("s",["ss",2],0,"second"),x("second","s"),P("second",15),L("s",Zt),L("ss",Zt,It),I(["s","ss"],cn);var ts=$("Seconds",!1);C("S",0,0,function(){return~~(this.millisecond()/100)}),C(0,["SS",2],0,function(){return~~(this.millisecond()/10)}),C(0,["SSS",3],0,"millisecond"),C(0,["SSSS",4],0,function(){return 10*this.millisecond()}),C(0,["SSSSS",5],0,function(){return 100*this.millisecond()}),C(0,["SSSSSS",6],0,function(){return 1e3*this.millisecond()}),C(0,["SSSSSSS",7],0,function(){return 1e4*this.millisecond()}),C(0,["SSSSSSSS",8],0,function(){return 1e5*this.millisecond()}),C(0,["SSSSSSSSS",9],0,function(){return 1e6*this.millisecond()}),x("millisecond","ms"),P("millisecond",16),L("S",Jt,jt),L("SS",Jt,It),L("SSS",Jt,Et);var ns;for(ns="SSSS";ns.length<=9;ns+="S")L(ns,Xt);for(ns="S";ns.length<=9;ns+="S")I(ns,function(e,t){t[fn]=w(1e3*("0."+e))});var ss=$("Milliseconds",!1);C("z",0,0,"zoneAbbr"),C("zz",0,0,"zoneName");var is=y.prototype;is.add=Bn,is.calendar=function(t,n){var s=t||Ie(),i=Be(s,this).startOf("day"),r=e.calendarFormat(this,i)||"sameElse",a=n&&(D(n[r])?n[r].call(this,s):n[r]);return this.format(a||this.localeData().calendar(r,this,Ie(s)))},is.clone=function(){return new y(this)},is.diff=function(e,t,n){var s,i,r;if(!this.isValid())return NaN;if(!(s=Be(e,this)).isValid())return NaN;switch(i=6e4*(s.utcOffset()-this.utcOffset()),t=T(t)){case"year":r=rt(this,s)/12;break;case"month":r=rt(this,s);break;case"quarter":r=rt(this,s)/3;break;case"second":r=(this-s)/1e3;break;case"minute":r=(this-s)/6e4;break;case"hour":r=(this-s)/36e5;break;case"day":r=(this-s-i)/864e5;break;case"week":r=(this-s-i)/6048e5;break;default:r=this-s}return n?r:p(r)},is.endOf=function(e){return void 0===(e=T(e))||"millisecond"===e?this:("date"===e&&(e="day"),this.startOf(e).add(1,"isoWeek"===e?"week":e).subtract(1,"ms"))},is.format=function(t){t||(t=this.isUtc()?e.defaultFormatUtc:e.defaultFormat);var n=N(this,t);return this.localeData().postformat(n)},is.from=function(e,t){return this.isValid()&&(g(e)&&e.isValid()||Ie(e).isValid())?Ke({to:this,from:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},is.fromNow=function(e){return this.from(Ie(),e)},is.to=function(e,t){return this.isValid()&&(g(e)&&e.isValid()||Ie(e).isValid())?Ke({from:this,to:e}).locale(this.locale()).humanize(!t):this.localeData().invalidDate()},is.toNow=function(e){return this.to(Ie(),e)},is.get=function(e){return e=T(e),D(this[e])?this[e]():this},is.invalidAt=function(){return c(this).overflow},is.isAfter=function(e,t){var n=g(e)?e:Ie(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=T(i(t)?"millisecond":t))?this.valueOf()>n.valueOf():n.valueOf()<this.clone().startOf(t).valueOf())},is.isBefore=function(e,t){var n=g(e)?e:Ie(e);return!(!this.isValid()||!n.isValid())&&("millisecond"===(t=T(i(t)?"millisecond":t))?this.valueOf()<n.valueOf():this.clone().endOf(t).valueOf()<n.valueOf())},is.isBetween=function(e,t,n,s){return("("===(s=s||"()")[0]?this.isAfter(e,n):!this.isBefore(e,n))&&(")"===s[1]?this.isBefore(t,n):!this.isAfter(t,n))},is.isSame=function(e,t){var n,s=g(e)?e:Ie(e);return!(!this.isValid()||!s.isValid())&&("millisecond"===(t=T(t||"millisecond"))?this.valueOf()===s.valueOf():(n=s.valueOf(),this.clone().startOf(t).valueOf()<=n&&n<=this.clone().endOf(t).valueOf()))},is.isSameOrAfter=function(e,t){return this.isSame(e,t)||this.isAfter(e,t)},is.isSameOrBefore=function(e,t){return this.isSame(e,t)||this.isBefore(e,t)},is.isValid=function(){return f(this)},is.lang=Xn,is.locale=at,is.localeData=ot,is.max=zn,is.min=An,is.parsingFlags=function(){return l({},c(this))},is.set=function(e,t){if("object"==typeof e)for(var n=W(e=b(e)),s=0;s<n.length;s++)this[n[s].unit](e[n[s].unit]);else if(e=T(e),D(this[e]))return this[e](t);return this},is.startOf=function(e){switch(e=T(e)){case"year":this.month(0);case"quarter":case"month":this.date(1);case"week":case"isoWeek":case"day":case"date":this.hours(0);case"hour":this.minutes(0);case"minute":this.seconds(0);case"second":this.milliseconds(0)}return"week"===e&&this.weekday(0),"isoWeek"===e&&this.isoWeekday(1),"quarter"===e&&this.month(3*Math.floor(this.month()/3)),this},is.subtract=Qn,is.toArray=function(){var e=this;return[e.year(),e.month(),e.date(),e.hour(),e.minute(),e.second(),e.millisecond()]},is.toObject=function(){var e=this;return{years:e.year(),months:e.month(),date:e.date(),hours:e.hours(),minutes:e.minutes(),seconds:e.seconds(),milliseconds:e.milliseconds()}},is.toDate=function(){return new Date(this.valueOf())},is.toISOString=function(){if(!this.isValid())return null;var e=this.clone().utc();return e.year()<0||e.year()>9999?N(e,"YYYYYY-MM-DD[T]HH:mm:ss.SSS[Z]"):D(Date.prototype.toISOString)?this.toDate().toISOString():N(e,"YYYY-MM-DD[T]HH:mm:ss.SSS[Z]")},is.inspect=function(){if(!this.isValid())return"moment.invalid(/* "+this._i+" */)";var e="moment",t="";this.isLocal()||(e=0===this.utcOffset()?"moment.utc":"moment.parseZone",t="Z");var n="["+e+'("]',s=0<=this.year()&&this.year()<=9999?"YYYY":"YYYYYY",i=t+'[")]';return this.format(n+s+"-MM-DD[T]HH:mm:ss.SSS"+i)},is.toJSON=function(){return this.isValid()?this.toISOString():null},is.toString=function(){return this.clone().locale("en").format("ddd MMM DD YYYY HH:mm:ss [GMT]ZZ")},is.unix=function(){return Math.floor(this.valueOf()/1e3)},is.valueOf=function(){return this._d.valueOf()-6e4*(this._offset||0)},is.creationData=function(){return{input:this._i,format:this._f,locale:this._locale,isUTC:this._isUTC,strict:this._strict}},is.year=gn,is.isLeapYear=function(){return Z(this.year())},is.weekYear=function(e){return lt.call(this,e,this.week(),this.weekday(),this.localeData()._week.dow,this.localeData()._week.doy)},is.isoWeekYear=function(e){return lt.call(this,e,this.isoWeek(),this.isoWeekday(),1,4)},is.quarter=is.quarters=function(e){return null==e?Math.ceil((this.month()+1)/3):this.month(3*(e-1)+this.month()%3)},is.month=ee,is.daysInMonth=function(){return Q(this.year(),this.month())},is.week=is.weeks=function(e){var t=this.localeData().week(this);return null==e?t:this.add(7*(e-t),"d")},is.isoWeek=is.isoWeeks=function(e){var t=ae(this,1,4).week;return null==e?t:this.add(7*(e-t),"d")},is.weeksInYear=function(){var e=this.localeData()._week;return oe(this.year(),e.dow,e.doy)},is.isoWeeksInYear=function(){return oe(this.year(),1,4)},is.date=Kn,is.day=is.days=function(e){if(!this.isValid())return null!=e?this:NaN;var t=this._isUTC?this._d.getUTCDay():this._d.getDay();return null!=e?(e=ue(e,this.localeData()),this.add(e-t,"d")):t},is.weekday=function(e){if(!this.isValid())return null!=e?this:NaN;var t=(this.day()+7-this.localeData()._week.dow)%7;return null==e?t:this.add(e-t,"d")},is.isoWeekday=function(e){if(!this.isValid())return null!=e?this:NaN;if(null!=e){var t=le(e,this.localeData());return this.day(this.day()%7?t:t-7)}return this.day()||7},is.dayOfYear=function(e){var t=Math.round((this.clone().startOf("day")-this.clone().startOf("year"))/864e5)+1;return null==e?t:this.add(e-t,"d")},is.hour=is.hours=Rn,is.minute=is.minutes=es,is.second=is.seconds=ts,is.millisecond=is.milliseconds=ss,is.utcOffset=function(t,n,s){var i,r=this._offset||0;if(!this.isValid())return null!=t?this:NaN;if(null!=t){if("string"==typeof t){if(null===(t=Je(tn,t)))return this}else Math.abs(t)<16&&!s&&(t*=60);return!this._isUTC&&n&&(i=Qe(this)),this._offset=t,this._isUTC=!0,null!=i&&this.add(i,"m"),r!==t&&(!n||this._changeInProgress?it(this,Ke(t-r,"m"),1,!1):this._changeInProgress||(this._changeInProgress=!0,e.updateOffset(this,!0),this._changeInProgress=null)),this}return this._isUTC?r:Qe(this)},is.utc=function(e){return this.utcOffset(0,e)},is.local=function(e){return this._isUTC&&(this.utcOffset(0,e),this._isUTC=!1,e&&this.subtract(Qe(this),"m")),this},is.parseZone=function(){if(null!=this._tzm)this.utcOffset(this._tzm,!1,!0);else if("string"==typeof this._i){var e=Je(en,this._i);null!=e?this.utcOffset(e):this.utcOffset(0,!0)}return this},is.hasAlignedHourOffset=function(e){return!!this.isValid()&&(e=e?Ie(e).utcOffset():0,(this.utcOffset()-e)%60==0)},is.isDST=function(){return this.utcOffset()>this.clone().month(0).utcOffset()||this.utcOffset()>this.clone().month(5).utcOffset()},is.isLocal=function(){return!!this.isValid()&&!this._isUTC},is.isUtcOffset=function(){return!!this.isValid()&&this._isUTC},is.isUtc=Xe,is.isUTC=Xe,is.zoneAbbr=function(){return this._isUTC?"UTC":""},is.zoneName=function(){return this._isUTC?"Coordinated Universal Time":""},is.dates=k("dates accessor is deprecated. Use date instead.",Kn),is.months=k("months accessor is deprecated. Use month instead",ee),is.years=k("years accessor is deprecated. Use year instead",gn),is.zone=k("moment().zone is deprecated, use moment().utcOffset instead. http://momentjs.com/guides/#/warnings/zone/",function(e,t){return null!=e?("string"!=typeof e&&(e=-e),this.utcOffset(e,t),this):-this.utcOffset()}),is.isDSTShifted=k("isDSTShifted is deprecated. See http://momentjs.com/guides/#/warnings/dst-shifted/ for more information",function(){if(!i(this._isDSTShifted))return this._isDSTShifted;var e={};if(_(e,this),(e=Ge(e))._a){var t=e._isUTC?d(e._a):Ie(e._a);this._isDSTShifted=this.isValid()&&v(e._a,t.toArray())>0}else this._isDSTShifted=!1;return this._isDSTShifted});var rs=O.prototype;rs.calendar=function(e,t,n){var s=this._calendar[e]||this._calendar.sameElse;return D(s)?s.call(t,n):s},rs.longDateFormat=function(e){var t=this._longDateFormat[e],n=this._longDateFormat[e.toUpperCase()];return t||!n?t:(this._longDateFormat[e]=n.replace(/MMMM|MM|DD|dddd/g,function(e){return e.slice(1)}),this._longDateFormat[e])},rs.invalidDate=function(){return this._invalidDate},rs.ordinal=function(e){return this._ordinal.replace("%d",e)},rs.preparse=ht,rs.postformat=ht,rs.relativeTime=function(e,t,n,s){var i=this._relativeTime[n];return D(i)?i(e,t,n,s):i.replace(/%d/i,e)},rs.pastFuture=function(e,t){var n=this._relativeTime[e>0?"future":"past"];return D(n)?n(t):n.replace(/%s/i,t)},rs.set=function(e){var t,n;for(n in e)D(t=e[n])?this[n]=t:this["_"+n]=t;this._config=e,this._dayOfMonthOrdinalParseLenient=new RegExp((this._dayOfMonthOrdinalParse.source||this._ordinalParse.source)+"|"+/\d{1,2}/.source)},rs.months=function(e,n){return e?t(this._months)?this._months[e.month()]:this._months[(this._months.isFormat||pn).test(n)?"format":"standalone"][e.month()]:t(this._months)?this._months:this._months.standalone},rs.monthsShort=function(e,n){return e?t(this._monthsShort)?this._monthsShort[e.month()]:this._monthsShort[pn.test(n)?"format":"standalone"][e.month()]:t(this._monthsShort)?this._monthsShort:this._monthsShort.standalone},rs.monthsParse=function(e,t,n){var s,i,r;if(this._monthsParseExact)return X.call(this,e,t,n);for(this._monthsParse||(this._monthsParse=[],this._longMonthsParse=[],this._shortMonthsParse=[]),s=0;s<12;s++){if(i=d([2e3,s]),n&&!this._longMonthsParse[s]&&(this._longMonthsParse[s]=new RegExp("^"+this.months(i,"").replace(".","")+"$","i"),this._shortMonthsParse[s]=new RegExp("^"+this.monthsShort(i,"").replace(".","")+"$","i")),n||this._monthsParse[s]||(r="^"+this.months(i,"")+"|^"+this.monthsShort(i,""),this._monthsParse[s]=new RegExp(r.replace(".",""),"i")),n&&"MMMM"===t&&this._longMonthsParse[s].test(e))return s;if(n&&"MMM"===t&&this._shortMonthsParse[s].test(e))return s;if(!n&&this._monthsParse[s].test(e))return s}},rs.monthsRegex=function(e){return this._monthsParseExact?(u(this,"_monthsRegex")||te.call(this),e?this._monthsStrictRegex:this._monthsRegex):(u(this,"_monthsRegex")||(this._monthsRegex=kn),this._monthsStrictRegex&&e?this._monthsStrictRegex:this._monthsRegex)},rs.monthsShortRegex=function(e){return this._monthsParseExact?(u(this,"_monthsRegex")||te.call(this),e?this._monthsShortStrictRegex:this._monthsShortRegex):(u(this,"_monthsShortRegex")||(this._monthsShortRegex=Mn),this._monthsShortStrictRegex&&e?this._monthsShortStrictRegex:this._monthsShortRegex)},rs.week=function(e){return ae(e,this._week.dow,this._week.doy).week},rs.firstDayOfYear=function(){return this._week.doy},rs.firstDayOfWeek=function(){return this._week.dow},rs.weekdays=function(e,n){return e?t(this._weekdays)?this._weekdays[e.day()]:this._weekdays[this._weekdays.isFormat.test(n)?"format":"standalone"][e.day()]:t(this._weekdays)?this._weekdays:this._weekdays.standalone},rs.weekdaysMin=function(e){return e?this._weekdaysMin[e.day()]:this._weekdaysMin},rs.weekdaysShort=function(e){return e?this._weekdaysShort[e.day()]:this._weekdaysShort},rs.weekdaysParse=function(e,t,n){var s,i,r;if(this._weekdaysParseExact)return de.call(this,e,t,n);for(this._weekdaysParse||(this._weekdaysParse=[],this._minWeekdaysParse=[],this._shortWeekdaysParse=[],this._fullWeekdaysParse=[]),s=0;s<7;s++){if(i=d([2e3,1]).day(s),n&&!this._fullWeekdaysParse[s]&&(this._fullWeekdaysParse[s]=new RegExp("^"+this.weekdays(i,"").replace(".",".?")+"$","i"),this._shortWeekdaysParse[s]=new RegExp("^"+this.weekdaysShort(i,"").replace(".",".?")+"$","i"),this._minWeekdaysParse[s]=new RegExp("^"+this.weekdaysMin(i,"").replace(".",".?")+"$","i")),this._weekdaysParse[s]||(r="^"+this.weekdays(i,"")+"|^"+this.weekdaysShort(i,"")+"|^"+this.weekdaysMin(i,""),this._weekdaysParse[s]=new RegExp(r.replace(".",""),"i")),n&&"dddd"===t&&this._fullWeekdaysParse[s].test(e))return s;if(n&&"ddd"===t&&this._shortWeekdaysParse[s].test(e))return s;if(n&&"dd"===t&&this._minWeekdaysParse[s].test(e))return s;if(!n&&this._weekdaysParse[s].test(e))return s}},rs.weekdaysRegex=function(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||he.call(this),e?this._weekdaysStrictRegex:this._weekdaysRegex):(u(this,"_weekdaysRegex")||(this._weekdaysRegex=xn),this._weekdaysStrictRegex&&e?this._weekdaysStrictRegex:this._weekdaysRegex)},rs.weekdaysShortRegex=function(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||he.call(this),e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex):(u(this,"_weekdaysShortRegex")||(this._weekdaysShortRegex=Tn),this._weekdaysShortStrictRegex&&e?this._weekdaysShortStrictRegex:this._weekdaysShortRegex)},rs.weekdaysMinRegex=function(e){return this._weekdaysParseExact?(u(this,"_weekdaysRegex")||he.call(this),e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex):(u(this,"_weekdaysMinRegex")||(this._weekdaysMinRegex=bn),this._weekdaysMinStrictRegex&&e?this._weekdaysMinStrictRegex:this._weekdaysMinRegex)},rs.isPM=function(e){return"p"===(e+"").toLowerCase().charAt(0)},rs.meridiem=function(e,t,n){return e>11?n?"pm":"PM":n?"am":"AM"},pe("en",{dayOfMonthOrdinalParse:/\d{1,2}(th|st|nd|rd)/,ordinal:function(e){var t=e%10;return e+(1===w(e%100/10)?"th":1===t?"st":2===t?"nd":3===t?"rd":"th")}}),e.lang=k("moment.lang is deprecated. Use moment.locale instead.",pe),e.langData=k("moment.langData is deprecated. Use moment.localeData instead.",ve);var as=Math.abs,os=wt("ms"),us=wt("s"),ls=wt("m"),ds=wt("h"),hs=wt("d"),cs=wt("w"),fs=wt("M"),ms=wt("y"),_s=vt("milliseconds"),ys=vt("seconds"),gs=vt("minutes"),ps=vt("hours"),ws=vt("days"),vs=vt("months"),Ms=vt("years"),ks=Math.round,Ss={ss:44,s:45,m:45,h:22,d:26,M:11},Ds=Math.abs,Ys=ze.prototype;return Ys.isValid=function(){return this._isValid},Ys.abs=function(){var e=this._data;return this._milliseconds=as(this._milliseconds),this._days=as(this._days),this._months=as(this._months),e.milliseconds=as(e.milliseconds),e.seconds=as(e.seconds),e.minutes=as(e.minutes),e.hours=as(e.hours),e.months=as(e.months),e.years=as(e.years),this},Ys.add=function(e,t){return _t(this,e,t,1)},Ys.subtract=function(e,t){return _t(this,e,t,-1)},Ys.as=function(e){if(!this.isValid())return NaN;var t,n,s=this._milliseconds;if("month"===(e=T(e))||"year"===e)return t=this._days+s/864e5,n=this._months+gt(t),"month"===e?n:n/12;switch(t=this._days+Math.round(pt(this._months)),e){case"week":return t/7+s/6048e5;case"day":return t+s/864e5;case"hour":return 24*t+s/36e5;case"minute":return 1440*t+s/6e4;case"second":return 86400*t+s/1e3;case"millisecond":return Math.floor(864e5*t)+s;default:throw new Error("Unknown unit "+e)}},Ys.asMilliseconds=os,Ys.asSeconds=us,Ys.asMinutes=ls,Ys.asHours=ds,Ys.asDays=hs,Ys.asWeeks=cs,Ys.asMonths=fs,Ys.asYears=ms,Ys.valueOf=function(){return this.isValid()?this._milliseconds+864e5*this._days+this._months%12*2592e6+31536e6*w(this._months/12):NaN},Ys._bubble=function(){var e,t,n,s,i,r=this._milliseconds,a=this._days,o=this._months,u=this._data;return r>=0&&a>=0&&o>=0||r<=0&&a<=0&&o<=0||(r+=864e5*yt(pt(o)+a),a=0,o=0),u.milliseconds=r%1e3,e=p(r/1e3),u.seconds=e%60,t=p(e/60),u.minutes=t%60,n=p(t/60),u.hours=n%24,a+=p(n/24),i=p(gt(a)),o+=i,a-=yt(pt(i)),s=p(o/12),o%=12,u.days=a,u.months=o,u.years=s,this},Ys.clone=function(){return Ke(this)},Ys.get=function(e){return e=T(e),this.isValid()?this[e+"s"]():NaN},Ys.milliseconds=_s,Ys.seconds=ys,Ys.minutes=gs,Ys.hours=ps,Ys.days=ws,Ys.weeks=function(){return p(this.days()/7)},Ys.months=vs,Ys.years=Ms,Ys.humanize=function(e){if(!this.isValid())return this.localeData().invalidDate();var t=this.localeData(),n=kt(this,!e,t);return e&&(n=t.pastFuture(+this,n)),t.postformat(n)},Ys.toISOString=Dt,Ys.toString=Dt,Ys.toJSON=Dt,Ys.locale=at,Ys.localeData=ot,Ys.toIsoString=k("toIsoString() is deprecated. Please use toISOString() instead (notice the capitals)",Dt),Ys.lang=Xn,C("X",0,0,"unix"),C("x",0,0,"valueOf"),L("x",Kt),L("X",nn),I("X",function(e,t,n){n._d=new Date(1e3*parseFloat(e,10))}),I("x",function(e,t,n){n._d=new Date(w(e))}),e.version="2.19.0",function(e){Yt=e}(Ie),e.fn=is,e.min=function(){return Ee("isBefore",[].slice.call(arguments,0))},e.max=function(){return Ee("isAfter",[].slice.call(arguments,0))},e.now=function(){return Date.now?Date.now():+new Date},e.utc=d,e.unix=function(e){return Ie(1e3*e)},e.months=function(e,t){return ft(e,t,"months")},e.isDate=a,e.locale=pe,e.invalid=m,e.duration=Ke,e.isMoment=g,e.weekdays=function(e,t,n){return mt(e,t,n,"weekdays")},e.parseZone=function(){return Ie.apply(null,arguments).parseZone()},e.localeData=ve,e.isDuration=Ze,e.monthsShort=function(e,t){return ft(e,t,"monthsShort")},e.weekdaysMin=function(e,t,n){return mt(e,t,n,"weekdaysMin")},e.defineLocale=we,e.updateLocale=function(e,t){if(null!=t){var n,s=Cn;null!=Fn[e]&&(s=Fn[e]._config),(n=new O(t=Y(s,t))).parentLocale=Fn[e],Fn[e]=n,pe(e)}else null!=Fn[e]&&(null!=Fn[e].parentLocale?Fn[e]=Fn[e].parentLocale:null!=Fn[e]&&delete Fn[e]);return Fn[e]},e.locales=function(){return Pt(Fn)},e.weekdaysShort=function(e,t,n){return mt(e,t,n,"weekdaysShort")},e.normalizeUnits=T,e.relativeTimeRounding=function(e){return void 0===e?ks:"function"==typeof e&&(ks=e,!0)},e.relativeTimeThreshold=function(e,t){return void 0!==Ss[e]&&(void 0===t?Ss[e]:(Ss[e]=t,"s"===e&&(Ss.ss=t-1),!0))},e.calendarFormat=function(e,t){var n=e.diff(t,"days",!0);return n<-6?"sameElse":n<-1?"lastWeek":n<0?"lastDay":n<1?"sameDay":n<2?"nextDay":n<7?"nextWeek":"sameElse"},e.prototype=is,e});
/*
 * jQuery BBQ: Back Button & Query Library - v1.2.1 - 2/17/2010
 * http://benalman.com/projects/jquery-bbq-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,p){var i,m=Array.prototype.slice,r=decodeURIComponent,a=$.param,c,l,v,b=$.bbq=$.bbq||{},q,u,j,e=$.event.special,d="hashchange",A="querystring",D="fragment",y="elemUrlAttr",g="location",k="href",t="src",x=/^.*\?|#.*$/g,w=/^.*\#/,h,C={};function E(F){return typeof F==="string"}function B(G){var F=m.call(arguments,1);return function(){return G.apply(this,F.concat(m.call(arguments)))}}function n(F){return F.replace(/^[^#]*#?(.*)$/,"$1")}function o(F){return F.replace(/(?:^[^?#]*\?([^#]*).*$)?.*/,"$1")}function f(H,M,F,I,G){var O,L,K,N,J;if(I!==i){K=F.match(H?/^([^#]*)\#?(.*)$/:/^([^#?]*)\??([^#]*)(#?.*)/);J=K[3]||"";if(G===2&&E(I)){L=I.replace(H?w:x,"")}else{N=l(K[2]);I=E(I)?l[H?D:A](I):I;L=G===2?I:G===1?$.extend({},I,N):$.extend({},N,I);L=a(L);if(H){L=L.replace(h,r)}}O=K[1]+(H?"#":L||!K[1]?"?":"")+L+J}else{O=M(F!==i?F:p[g][k])}return O}a[A]=B(f,0,o);a[D]=c=B(f,1,n);c.noEscape=function(G){G=G||"";var F=$.map(G.split(""),encodeURIComponent);h=new RegExp(F.join("|"),"g")};c.noEscape(",/");$.deparam=l=function(I,F){var H={},G={"true":!0,"false":!1,"null":null};$.each(I.replace(/\+/g," ").split("&"),function(L,Q){var K=Q.split("="),P=r(K[0]),J,O=H,M=0,R=P.split("]["),N=R.length-1;if(/\[/.test(R[0])&&/\]$/.test(R[N])){R[N]=R[N].replace(/\]$/,"");R=R.shift().split("[").concat(R);N=R.length-1}else{N=0}if(K.length===2){J=r(K[1]);if(F){J=J&&!isNaN(J)?+J:J==="undefined"?i:G[J]!==i?G[J]:J}if(N){for(;M<=N;M++){P=R[M]===""?O.length:R[M];O=O[P]=M<N?O[P]||(R[M+1]&&isNaN(R[M+1])?{}:[]):J}}else{if($.isArray(H[P])){H[P].push(J)}else{if(H[P]!==i){H[P]=[H[P],J]}else{H[P]=J}}}}else{if(P){H[P]=F?i:""}}});return H};function z(H,F,G){if(F===i||typeof F==="boolean"){G=F;F=a[H?D:A]()}else{F=E(F)?F.replace(H?w:x,""):F}return l(F,G)}l[A]=B(z,0);l[D]=v=B(z,1);$[y]||($[y]=function(F){return $.extend(C,F)})({a:k,base:k,iframe:t,img:t,input:t,form:"action",link:k,script:t});j=$[y];function s(I,G,H,F){if(!E(H)&&typeof H!=="object"){F=H;H=G;G=i}return this.each(function(){var L=$(this),J=G||j()[(this.nodeName||"").toLowerCase()]||"",K=J&&L.attr(J)||"";L.attr(J,a[I](K,H,F))})}$.fn[A]=B(s,A);$.fn[D]=B(s,D);b.pushState=q=function(I,F){if(E(I)&&/^#/.test(I)&&F===i){F=2}var H=I!==i,G=c(p[g][k],H?I:{},H?F:2);p[g][k]=G+(/#/.test(G)?"":"#")};b.getState=u=function(F,G){return F===i||typeof F==="boolean"?v(F):v(G)[F]};b.removeState=function(F){var G={};if(F!==i){G=u();$.each($.isArray(F)?F:arguments,function(I,H){delete G[H]})}q(G,2)};e[d]=$.extend(e[d],{add:function(F){var H;function G(J){var I=J[D]=c();J.getState=function(K,L){return K===i||typeof K==="boolean"?l(I,K):l(I,L)[K]};H.apply(this,arguments)}if($.isFunction(F)){H=F;return G}else{H=F.handler;F.handler=G}}})})(jQuery,this);
/*
 * jQuery hashchange event - v1.2 - 2/11/2010
 * http://benalman.com/projects/jquery-hashchange-plugin/
 * 
 * Copyright (c) 2010 "Cowboy" Ben Alman
 * Dual licensed under the MIT and GPL licenses.
 * http://benalman.com/about/license/
 */
(function($,i,b){var j,k=$.event.special,c="location",d="hashchange",l="href",f=$.browser,g=document.documentMode,h=f.msie&&(g===b||g<8),e="on"+d in i&&!h;function a(m){m=m||i[c][l];return m.replace(/^[^#]*#?(.*)$/,"$1")}$[d+"Delay"]=100;k[d]=$.extend(k[d],{setup:function(){if(e){return false}$(j.start)},teardown:function(){if(e){return false}$(j.stop)}});j=(function(){var m={},r,n,o,q;function p(){o=q=function(s){return s};if(h){n=$('<iframe src="javascript:0"/>').hide().insertAfter("body")[0].contentWindow;q=function(){return a(n.document[c][l])};o=function(u,s){if(u!==s){var t=n.document;t.open().close();t[c].hash="#"+u}};o(a())}}m.start=function(){if(r){return}var t=a();o||p();(function s(){var v=a(),u=q(t);if(v!==t){o(t=v,u);$(i).trigger(d)}else{if(u!==t){i[c][l]=i[c][l].replace(/#.*/,"")+"#"+u}}r=setTimeout(s,$[d+"Delay"])})()};m.stop=function(){if(!n){r&&clearTimeout(r);r=0}};return m})()})(jQuery,this);
/**
* jquery.matchHeight-min.js v0.5.2
* http://brm.io/jquery-match-height/
* License: MIT
*/
(function(b){var f=-1,e=-1,m=function(a){var d=null,c=[];b(a).each(function(){var a=b(this),h=a.offset().top-g(a.css("margin-top")),k=0<c.length?c[c.length-1]:null;null===k?c.push(a):1>=Math.floor(Math.abs(d-h))?c[c.length-1]=k.add(a):c.push(a);d=h});return c},g=function(b){return parseFloat(b)||0};b.fn.matchHeight=function(a){if("remove"===a){var d=this;this.css("height","");b.each(b.fn.matchHeight._groups,function(b,a){a.elements=a.elements.not(d)});return this}if(1>=this.length)return this;a="undefined"!==
typeof a?a:!0;b.fn.matchHeight._groups.push({elements:this,byRow:a});b.fn.matchHeight._apply(this,a);return this};b.fn.matchHeight._groups=[];b.fn.matchHeight._throttle=80;b.fn.matchHeight._maintainScroll=!1;b.fn.matchHeight._apply=function(a,d){var c=b(a),e=[c],h=b(window).scrollTop(),k=b("html").outerHeight(!0),f=c.parents().filter(":hidden");f.css("display","block");d&&(c.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.data("style-cache",a.attr("style"));
a.css({display:c,"padding-top":"0","padding-bottom":"0","border-top-width":"0","border-bottom-width":"0",height:"100px"})}),e=m(c),c.each(function(){var a=b(this);a.attr("style",a.data("style-cache")||"").css("height","")}));b.each(e,function(a,c){var e=b(c),f=0;d&&1>=e.length||(e.each(function(){var a=b(this),c="inline-block"===a.css("display")?"inline-block":"block";a.css({display:c,height:""});a.outerHeight(!1)>f&&(f=a.outerHeight(!1));a.css("display","")}),e.each(function(){var a=b(this),c=0;
"border-box"!==a.css("box-sizing")&&(c+=g(a.css("border-top-width"))+g(a.css("border-bottom-width")),c+=g(a.css("padding-top"))+g(a.css("padding-bottom")));a.css("height",f-c)}))});f.css("display","");b.fn.matchHeight._maintainScroll&&b(window).scrollTop(h/k*b("html").outerHeight(!0));return this};b.fn.matchHeight._applyDataApi=function(){var a={};b("[data-match-height], [data-mh]").each(function(){var d=b(this),c=d.attr("data-match-height")||d.attr("data-mh");a[c]=c in a?a[c].add(d):d});b.each(a,
function(){this.matchHeight(!0)})};var l=function(){b.each(b.fn.matchHeight._groups,function(){b.fn.matchHeight._apply(this.elements,this.byRow)})};b.fn.matchHeight._update=function(a,d){if(d&&"resize"===d.type){var c=b(window).width();if(c===f)return;f=c}a?-1===e&&(e=setTimeout(function(){l();e=-1},b.fn.matchHeight._throttle)):l()};b(b.fn.matchHeight._applyDataApi);b(window).bind("load",function(a){b.fn.matchHeight._update()});b(window).bind("resize orientationchange",function(a){b.fn.matchHeight._update(!0,
a)})})(jQuery);
/*!
 * hoverIntent v1.8.0 // 2014.06.29 // jQuery v1.9.1+
 * http://cherne.net/brian/resources/jquery.hoverIntent.html
 *
 * You may use hoverIntent under the terms of the MIT license. Basically that
 * means you are free to use hoverIntent as long as this header is left intact.
 * Copyright 2007, 2014 Brian Cherne
 */
(function($){$.fn.hoverIntent=function(handlerIn,handlerOut,selector){var cfg={interval:100,sensitivity:6,timeout:0};if(typeof handlerIn==="object"){cfg=$.extend(cfg,handlerIn)}else{if($.isFunction(handlerOut)){cfg=$.extend(cfg,{over:handlerIn,out:handlerOut,selector:selector})}else{cfg=$.extend(cfg,{over:handlerIn,out:handlerIn,selector:handlerOut})}}var cX,cY,pX,pY;var track=function(ev){cX=ev.pageX;cY=ev.pageY};var compare=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);if(Math.sqrt((pX-cX)*(pX-cX)+(pY-cY)*(pY-cY))<cfg.sensitivity){$(ob).off("mousemove.hoverIntent",track);ob.hoverIntent_s=true;return cfg.over.apply(ob,[ev])}else{pX=cX;pY=cY;ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}};var delay=function(ev,ob){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t);ob.hoverIntent_s=false;return cfg.out.apply(ob,[ev])};var handleHover=function(e){var ev=$.extend({},e);var ob=this;if(ob.hoverIntent_t){ob.hoverIntent_t=clearTimeout(ob.hoverIntent_t)}if(e.type==="mouseenter"){pX=ev.pageX;pY=ev.pageY;$(ob).on("mousemove.hoverIntent",track);if(!ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){compare(ev,ob)},cfg.interval)}}else{$(ob).off("mousemove.hoverIntent",track);if(ob.hoverIntent_s){ob.hoverIntent_t=setTimeout(function(){delay(ev,ob)},cfg.timeout)}}};return this.on({"mouseenter.hoverIntent":handleHover,"mouseleave.hoverIntent":handleHover},cfg.selector)}})(jQuery);
/*
 * debouncedresize: special jQuery event that happens once after a window resize
 *
 * latest version and complete README available on Github:
 * https://github.com/louisremi/jquery-smartresize
 *
 * Copyright 2012 @louis_remi
 * Licensed under the MIT license.
 *
 * This saved you an hour of work? 
 * Send me music http://www.amazon.co.uk/wishlist/HNTU0468LQON
 */
(function($) {

var $event = $.event,
  $special,
  resizeTimeout;

$special = $event.special.debouncedresize = {
  setup: function() {
    $( this ).on( "resize", $special.handler );
  },
  teardown: function() {
    $( this ).off( "resize", $special.handler );
  },
  handler: function( event, execAsap ) {
    // Save the context
    var context = this,
      args = arguments,
      dispatch = function() {
        // set correct event type
        event.type = "debouncedresize";
        $event.dispatch.apply( context, args );
      };

    if ( resizeTimeout ) {
      clearTimeout( resizeTimeout );
    }

    execAsap ?
      dispatch() :
      resizeTimeout = setTimeout( dispatch, $special.threshold );
  },
  threshold: 150
};

})($CQ);
/*
 * Adobe Systems Incorporated
 * Modified: October 30th, 2012
 *
 * Picturefill - Responsive Images that work today. (and mimic the proposed Picture element with divs).
 * Author: Scott Jehl, Filament Group, 2012 | License: MIT/GPLv2
 */

(function ($, w) {

    // Enable strict mode
    "use strict";

    w.picturefill = function (context) {
        var undefined;
        if (context === undefined) {
            context = $("body");
        }

        $("div[data-picture]", context).each(function () {
            var currentPicture = this;
            var matches = [];
            $("div[data-media]", currentPicture).each(function () {
                var media = $(this).attr("data-media");
                if (!media || ( w.matchMedia && w.matchMedia(media).matches )) {
                    matches.push(this);
                }
            });

            var $picImg = $("img", currentPicture).first();

            if (matches.length) {
                if ($picImg.size() === 0) {
                    var $currentPicture = $(currentPicture);
                    $picImg = $("<img />").attr("alt", $currentPicture.attr("data-alt")).appendTo($currentPicture);
                }
                $picImg.attr("src", matches.pop().getAttribute("data-src"));
            } else {
                $picImg.remove();
            }
        });
    };

    // Run on debounced resize and domready
    $(function () {
        w.picturefill();
    });

    $(w).on("debouncedresize", function () {
        w.picturefill();
    });

}($CQ, this));
//jira-feedback.js

// if(location.pathname != "/cf"){
// Requires jQuery!

jQuery.ajax({
  url: "https://umlsait.atlassian.net/s/1e77fca8ba5f71da362565f050d4ed88-T/en_US-xq2puv/64014/26/1.4.24/_/download/batch/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs/com.atlassian.jira.collector.plugin.jira-issue-collector-plugin:issuecollector-embededjs.js?collectorId=00697914",
  type: "get",
  cache: true,
  dataType: "script"
});

window.ATL_JQ_PAGE_PROPS =  {
"triggerFunction": function(showCollectorDialog) {
  //Requires that jQuery is available! 
  jQuery("#myCustomTrigger").click(function(e) {
    console.log("report bug");    
    e.preventDefault();
    showCollectorDialog();
  });
}};

$(function(){
  if(window.parent.location.pathname == "/cf" ){
      $("#myCustomTrigger").hide(); //("#cq-cf-frame").contents().find
  } else if (window.parent.location.pathname.search("editor.html")>0 ) {
    $("#myCustomTrigger").hide();
  }
})



$(document).ready(function() {
    var audioVideoElements = $("audio"); //video
    if (audioVideoElements.length > 0) {
        Modernizr.load([{
            test: typeof mejs === "object",
            nope: [
                "//cdnjs.cloudflare.com/ajax/libs/mediaelement/2.13.2/js/mediaelement-and-player.min.js",
                "//cdnjs.cloudflare.com/ajax/libs/mediaelement/2.13.2/css/mediaelementplayer.min.css"
            ],
            complete: function() {
                console.log("Library Loaded");
                audioVideoElements.mediaelementplayer({
                    // if the <video width> is not specified, this is the default
                    defaultVideoWidth: 480,
                    // if the <video height> is not specified, this is the default
                    defaultVideoHeight: 270,
                    // if set, overrides <video width>
                    videoWidth: -1,
                    // if set, overrides <video height>
                    videoHeight: -1,
                    // width of audio player
                    audioWidth: 400,
                    // height of audio player
                    audioHeight: 30,
                    // initial volume when the player starts
                    startVolume: 0.8,
                    // useful for <audio> player loops
                    loop: false,
                    // enables Flash and Silverlight to resize to content size
                    enableAutosize: true,
                    // the order of controls you want on the control bar (and other plugins below)
                    features: ['playpause','progress','tracks','fullscreen'],

                    // Hide controls when playing and mouse is not over the video
                    alwaysShowControls: false,
                    // force iPad's native controls
                    iPadUseNativeControls: true,
                    // force iPhone's native controls
                    iPhoneUseNativeControls: true, 
                    // force Android's native controls
                    AndroidUseNativeControls: true,
                    // forces the hour marker (##:00:00)
                    alwaysShowHours: false,
                    // show framecount in timecode (##:00:00:00)
                    showTimecodeFrameCount: false,
                    // used when showTimecodeFrameCount is set to true
                    framesPerSecond: 25,
                    // turns keyboard support on and off for this instance
                    enableKeyboard: true,
                    // when this player starts, it will pause other players
                    pauseOtherPlayers: true,
                    // array of keyboard commands
                    keyActions: [],                 
                });
                
            }
        }]);
    }
});
